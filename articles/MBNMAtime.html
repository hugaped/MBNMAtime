<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MBNMAtime">
<title>MBNMAtime for time-course Model-Based (Network) Meta-Analysis • MBNMAtime</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MBNMAtime for time-course Model-Based (Network) Meta-Analysis">
<meta property="og:description" content="MBNMAtime">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MBNMAtime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/MBNMAtime.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>MBNMAtime for time-course Model-Based (Network) Meta-Analysis</h1>
                        <h4 data-toc-skip class="author">Hugo
Pedder</h4>
            
            <h4 data-toc-skip class="date">2023-03-14</h4>
      
      
      <div class="d-none name"><code>MBNMAtime.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use <code>MBNMAtime</code> to
perform meta-analysis of studies with multiple follow-up measurements in
order to account for time-course relationships within single or multiple
treatment comparisons. This can be performed by conducting Model-Based
(Network) Meta-Analysis (MBNMA) to pool relative treatment effects.
MBNMA models therefore estimate treatment effects over time (e.g. days,
weeks, months).</p>
<p>Including all available follow-up measurements within a study makes
use of all the available evidence in a way that maintains connectivity
between treatments and explains how the response of the treatment
changes over time, thus accounting for heterogeneity and inconsistency
that may be present from “lumping” together different time points in a
standard Network Meta-Analysis (NMA). All models and analyses are
implemented in a Bayesian framework, following an extension of the
standard NMA methodology presented by <span class="citation">(Lu and
Ades 2004)</span> and are run in JAGS <em>(version 4.3.0 or later is
required)</em> <span class="citation">(JAGS Computer Program
2017)</span>. For full details of time-course MBNMA methodology see
Pedder et al. <span class="citation">(2019)</span>, and a simulation
study exploring the statistical properties of the method is reported in
Pedder et al. <span class="citation">(2020)</span>.</p>
<p>This package has been developed alongside <code>MBNMAdose</code>, a
package that allows users to perform dose-response MBNMA to allow for
modelling of dose-response relationships between different agents within
a network. However, <em>they should not be loaded into R at the same
time</em> as there are a number of functions with shared names that
perform similar tasks yet are specific to dealing with either
time-course <em>or</em> dose-response data.</p>
<p>Within the vignette, some models have not been evaluated, or have
been run with fewer iterations than would be necessary to achieve
convergence and produce valid results in practice. This has been done to
speed up computation and rendering of the vignette.</p>
<div class="section level3">
<h3 id="workflow-within-the-package">Workflow within the package<a class="anchor" aria-label="anchor" href="#workflow-within-the-package"></a>
</h3>
<p>Functions within <code>MBNMAtime</code> follow a clear pattern of
use:</p>
<ol style="list-style-type: decimal">
<li>Load your data into the correct format using
<code><a href="../reference/mb.network.html">mb.network()</a></code>
</li>
<li>Specify a suitable time-course function and analyse your data using
<code><a href="../reference/mb.run.html">mb.run()</a></code>
</li>
<li>Test for consistency using functions like
<code><a href="../reference/mb.nodesplit.html">mb.nodesplit()</a></code>
</li>
<li>Examine model results using forest plots and treatment rankings</li>
<li>Use your model to predict responses or estimate treatment effects at
specific time-points using <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
</li>
</ol>
<p>At each of these stages there are a number of informative graphs that
can be generated to help understand the data and make decisions
regarding model fitting.</p>
</div>
</div>
<div class="section level2">
<h2 id="datasets-included-in-the-package">Datasets Included in the Package<a class="anchor" aria-label="anchor" href="#datasets-included-in-the-package"></a>
</h2>
<div class="section level3">
<h3 id="pain-relief-in-osteoarthritis">Pain relief in osteoarthritis<a class="anchor" aria-label="anchor" href="#pain-relief-in-osteoarthritis"></a>
</h3>
<p><code>osteopain</code> is from a systematic review of treatments for
pain in osteoarthritis, used previously in Pedder et al. <span class="citation">(2019)</span>. The outcome is pain measured on a
continuous scale, and aggregate data responses correspond to the mean
WOMAC pain score at different follow-up times. The dataset includes 30
Randomised-Controlled Trials (RCTs), comparing 29 different treatments
(including placebo). <code>osteopain</code> is a data frame in long
format (one row per time point, arm and study), with the variables
<code>studyID</code>, <code>time</code>, <code>y</code>,
<code>se</code>, <code>treatment</code> and <code>arm</code>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">studyID</th>
<th align="right">time</th>
<th align="right">y</th>
<th align="right">se</th>
<th align="left">treatment</th>
<th align="right">arm</th>
<th align="left">treatname</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Baerwald 2010</td>
<td align="right">0</td>
<td align="right">6.55</td>
<td align="right">0.09</td>
<td align="left">Pl_0</td>
<td align="right">1</td>
<td align="left">Placebo_0</td>
</tr>
<tr class="even">
<td align="left">Baerwald 2010</td>
<td align="right">2</td>
<td align="right">5.40</td>
<td align="right">0.09</td>
<td align="left">Pl_0</td>
<td align="right">1</td>
<td align="left">Placebo_0</td>
</tr>
<tr class="odd">
<td align="left">Baerwald 2010</td>
<td align="right">6</td>
<td align="right">4.97</td>
<td align="right">0.10</td>
<td align="left">Pl_0</td>
<td align="right">1</td>
<td align="left">Placebo_0</td>
</tr>
<tr class="even">
<td align="left">Baerwald 2010</td>
<td align="right">13</td>
<td align="right">4.75</td>
<td align="right">0.11</td>
<td align="left">Pl_0</td>
<td align="right">1</td>
<td align="left">Placebo_0</td>
</tr>
<tr class="odd">
<td align="left">Baerwald 2010</td>
<td align="right">0</td>
<td align="right">6.40</td>
<td align="right">0.13</td>
<td align="left">Na_1000</td>
<td align="right">2</td>
<td align="left">Naproxen_1000</td>
</tr>
<tr class="even">
<td align="left">Baerwald 2010</td>
<td align="right">2</td>
<td align="right">4.03</td>
<td align="right">0.13</td>
<td align="left">Na_1000</td>
<td align="right">2</td>
<td align="left">Naproxen_1000</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="alogliptin-for-lowering-blood-glucose-concentration-in-type-ii-diabetes">Alogliptin for lowering blood glucose concentration in type II
diabetes<a class="anchor" aria-label="anchor" href="#alogliptin-for-lowering-blood-glucose-concentration-in-type-ii-diabetes"></a>
</h3>
<p><code>alog_pcfb</code> is from a systematic review of
Randomised-Controlled Trials (RCTs) comparing different doses of
alogliptin with placebo <span class="citation">(Langford et al.
2016)</span>. The systematic review was simply performed and was
intended to provide data to illustrate a statistical methodology rather
than for clinical inference. Alogliptin is a treatment aimed at reducing
blood glucose concentration in type II diabetes. The outcome is
continuous, and aggregate data responses correspond to the mean change
in HbA1c from baseline to follow-up in studies of at least 12 weeks
follow-up. The dataset includes 14 Randomised-Controlled Trials (RCTs),
comparing 5 different doses of alogliptin with placebo (6 different
treatments in total). <code>alog_pcfb</code> is a data frame in long
format (one row per time point, arm and study), with the variables
<code>studyID</code>, <code>clinicaltrialGov_ID</code>,
<code>agent</code>, <code>dose</code>, <code>treatment</code>,
<code>time</code>, <code>y</code>, <code>se</code>, and
<code>N</code>.</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="27%">
<col width="14%">
<col width="8%">
<col width="13%">
<col width="6%">
<col width="8%">
<col width="6%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="right">studyID</th>
<th align="left">clinicaltrialGov_ID</th>
<th align="left">agent</th>
<th align="right">dose</th>
<th align="left">treatment</th>
<th align="right">time</th>
<th align="right">y</th>
<th align="right">se</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">0.00</td>
<td align="left">placebo</td>
<td align="right">2</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">6.25</td>
<td align="left">alog_6.25</td>
<td align="right">2</td>
<td align="right">-0.16</td>
<td align="right">0.02</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">12.50</td>
<td align="left">alog_12.5</td>
<td align="right">2</td>
<td align="right">-0.17</td>
<td align="right">0.02</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">25.00</td>
<td align="left">alog_25</td>
<td align="right">2</td>
<td align="right">-0.16</td>
<td align="right">0.02</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">50.00</td>
<td align="left">alog_50</td>
<td align="right">2</td>
<td align="right">-0.15</td>
<td align="right">0.02</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">NCT01263470</td>
<td align="left">alogliptin</td>
<td align="right">0.00</td>
<td align="left">placebo</td>
<td align="right">4</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">75</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="tiotropium-aclidinium-and-placebo-for-maintenance-treatment-of-moderate-to-severe-chronic-obstructive-pulmonary-disease">Tiotropium, Aclidinium and Placebo for maintenance treatment of
moderate to severe chronic obstructive pulmonary disease<a class="anchor" aria-label="anchor" href="#tiotropium-aclidinium-and-placebo-for-maintenance-treatment-of-moderate-to-severe-chronic-obstructive-pulmonary-disease"></a>
</h3>
<p>A dataset from a systematic review of Randomised-Controlled Trials
(RCTs) for maintenance treatment of moderate to severe chronic
obstructive pulmonary disease (COPD) <span class="citation">(Karabis et
al. 2013)</span>. Data are extracted from <span class="citation">(Tallarita, De lorio, and Baio 2019)</span>. SEs were
imputed for three studies, and number of patients randomised were
imputed for one study (LAS 39) in which they were missing, using the
median standard deviation calculated from other studies in the dataset.
The outcome is trough Forced Expiratory Volume in 1 second (FEV1),
measured in litres and reported in each study arm as mean change from
baseline to follow-up. The dataset includes 13 RCTs, comparing 2
treatments (Tiotropium and Aclidinium) and placebo. <code>copd</code> is
a data frame in long format (one row per observation, arm and study),
with the variables <code>studyID</code>, <code>time</code>,
<code>y</code>, <code>se</code>, <code>treatment</code>, and
<code>n</code>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">studyID</th>
<th align="right">time</th>
<th align="right">y</th>
<th align="right">se</th>
<th align="left">treatment</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ACCORD I</td>
<td align="right">1</td>
<td align="right">-0.01</td>
<td align="right">0.01</td>
<td align="left">Placebo</td>
<td align="right">187</td>
</tr>
<tr class="even">
<td align="left">ACCORD I</td>
<td align="right">4</td>
<td align="right">-0.01</td>
<td align="right">0.01</td>
<td align="left">Placebo</td>
<td align="right">187</td>
</tr>
<tr class="odd">
<td align="left">ACCORD I</td>
<td align="right">8</td>
<td align="right">-0.01</td>
<td align="right">0.01</td>
<td align="left">Placebo</td>
<td align="right">187</td>
</tr>
<tr class="even">
<td align="left">ACCORD I</td>
<td align="right">12</td>
<td align="right">-0.02</td>
<td align="right">0.01</td>
<td align="left">Placebo</td>
<td align="right">187</td>
</tr>
<tr class="odd">
<td align="left">ACCORD I</td>
<td align="right">1</td>
<td align="right">0.10</td>
<td align="right">0.01</td>
<td align="left">Aclidinium</td>
<td align="right">190</td>
</tr>
<tr class="even">
<td align="left">ACCORD I</td>
<td align="right">4</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="left">Aclidinium</td>
<td align="right">190</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="body-weight-reduction-in-obesity-patients">Body weight reduction in obesity patients<a class="anchor" aria-label="anchor" href="#body-weight-reduction-in-obesity-patients"></a>
</h3>
<p><code>obesityBW_CFB</code> is from a systematic review of
pharmacological treatments for obesity. The outcome measured is change
from baseline in body weight (kg) at different follow-up times. 35 RCTs
are included that investigate 26 different treatments (16 agents/agent
combinations compared at different doses). <code>obesityBW_CFB</code> is
a dataset in long format (one row per time point, arm and study), with
the variables <code>studyID</code>, <code>time</code>, <code>y</code>,
<code>se</code>, <code>N</code>, <code>treatment</code>,
<code>arm</code>, <code>treatname</code>, <code>agent</code> and
<code>class</code>.</p>
<p><code>class</code> is the class of a particular <code>agent</code>
(e.g. Lipase inhibitor)</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="17%">
<col width="7%">
<col width="7%">
<col width="5%">
<col width="3%">
<col width="11%">
<col width="20%">
<col width="14%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">studyID</th>
<th align="right">time</th>
<th align="right">y</th>
<th align="right">se</th>
<th align="right">n</th>
<th align="left">treatment</th>
<th align="left">treatname</th>
<th align="left">agent</th>
<th align="left">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">27</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">4.35</td>
<td align="right">-1.00</td>
<td align="right">0.39</td>
<td align="right">78</td>
<td align="left">plac</td>
<td align="left">placebo</td>
<td align="left">placebo</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">28</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">4.35</td>
<td align="right">-1.59</td>
<td align="right">0.38</td>
<td align="right">81</td>
<td align="left">sibu_10MG</td>
<td align="left">sibutramine 10MG</td>
<td align="left">sibutramine</td>
<td align="left">SNRI</td>
</tr>
<tr class="odd">
<td align="left">29</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">8.70</td>
<td align="right">-1.59</td>
<td align="right">0.40</td>
<td align="right">78</td>
<td align="left">plac</td>
<td align="left">placebo</td>
<td align="left">placebo</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">8.70</td>
<td align="right">-3.01</td>
<td align="right">0.39</td>
<td align="right">81</td>
<td align="left">sibu_10MG</td>
<td align="left">sibutramine 10MG</td>
<td align="left">sibutramine</td>
<td align="left">SNRI</td>
</tr>
<tr class="odd">
<td align="left">31</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">13.04</td>
<td align="right">-2.25</td>
<td align="right">0.41</td>
<td align="right">78</td>
<td align="left">plac</td>
<td align="left">placebo</td>
<td align="left">placebo</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">32</td>
<td align="left">Apfelbaum 1999</td>
<td align="right">13.04</td>
<td align="right">-4.76</td>
<td align="right">0.40</td>
<td align="right">81</td>
<td align="left">sibu_10MG</td>
<td align="left">sibutramine 10MG</td>
<td align="left">sibutramine</td>
<td align="left">SNRI</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="serum-uric-acid-concentration-in-gout">Serum uric acid concentration in gout<a class="anchor" aria-label="anchor" href="#serum-uric-acid-concentration-in-gout"></a>
</h3>
<p><code>goutSUA_CFB</code> is from a systematic review of interventions
for lowering Serum Uric Acid (SUA) concentration in patients with gout
<em>[not published previously]</em>. The outcome is continuous, and
aggregate data responses correspond to the mean change from baseline in
SUA in mg/dL at different follow-up times. The dataset includes 28 RCTs,
comparing 41 treatments (8 agents compared at different doses).
<code>goutSUA_CFB</code> is a data frame in long format (one row per arm
and study), with the variables <code>studyID</code>, <code>time</code>,
<code>y</code>, <code>se</code>, <code>treatment</code>,
<code>arm</code>, <code>class</code> and <code>treatname</code>.</p>
<table class="table">
<thead><tr class="header">
<th align="right">studyID</th>
<th align="right">time</th>
<th align="right">y</th>
<th align="right">se</th>
<th align="left">treatment</th>
<th align="left">treatname</th>
<th align="left">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1102</td>
<td align="right">1</td>
<td align="right">0.07</td>
<td align="right">0.25</td>
<td align="left">RDEA_100</td>
<td align="left">RDEA594_100</td>
<td align="left">RDEA</td>
</tr>
<tr class="even">
<td align="right">1102</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.18</td>
<td align="left">RDEA_200</td>
<td align="left">RDEA594_200</td>
<td align="left">RDEA</td>
</tr>
<tr class="odd">
<td align="right">1102</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.25</td>
<td align="left">RDEA_400</td>
<td align="left">RDEA594_400</td>
<td align="left">RDEA</td>
</tr>
<tr class="even">
<td align="right">1102</td>
<td align="right">2</td>
<td align="right">-0.53</td>
<td align="right">0.25</td>
<td align="left">RDEA_100</td>
<td align="left">RDEA594_100</td>
<td align="left">RDEA</td>
</tr>
<tr class="odd">
<td align="right">1102</td>
<td align="right">2</td>
<td align="right">-1.37</td>
<td align="right">0.18</td>
<td align="left">RDEA_200</td>
<td align="left">RDEA594_200</td>
<td align="left">RDEA</td>
</tr>
<tr class="even">
<td align="right">1102</td>
<td align="right">2</td>
<td align="right">-1.73</td>
<td align="right">0.25</td>
<td align="left">RDEA_400</td>
<td align="left">RDEA594_400</td>
<td align="left">RDEA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="inspecting-the-data">Inspecting the data<a class="anchor" aria-label="anchor" href="#inspecting-the-data"></a>
</h2>
<p>Before embarking on an analysis, the first step is to have a look at
the raw data. Two features (network connectivity and time-course
relationship) are particularly important for MBNMA. To investigate these
we must first get our dataset into the right format for the package. We
can do this using <code><a href="../reference/mb.network.html">mb.network()</a></code>. This requires specifying
the desired treatment to use for the network reference treatment, though
one will automatically be specified if not given.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the pain dataset</span></span>
<span><span class="va">network.pain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">osteopain</span>, reference <span class="op">=</span> <span class="st">"Pl_0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Studies reporting change from baseline automatically identified from the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">network.pain</span><span class="op">)</span></span>
<span><span class="co">#&gt; description :</span></span>
<span><span class="co">#&gt; [1] "Network"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data.ab :</span></span>
<span><span class="co">#&gt;             studyID time treatment narm arm     y        se     treatname</span></span>
<span><span class="co">#&gt; 1 Gottesdiener 2002    0         1    6   1 7.062 0.2221675     Placebo_0</span></span>
<span><span class="co">#&gt; 2 Gottesdiener 2002    0         6    6   2 7.009 0.1605568 Etoricoxib_10</span></span>
<span><span class="co">#&gt; 3 Gottesdiener 2002    0         7    6   3 6.756 0.1696070 Etoricoxib_30</span></span>
<span><span class="co">#&gt; 4 Gottesdiener 2002    0         8    6   4 6.873 0.1584104  Etoricoxib_5</span></span>
<span><span class="co">#&gt; 5 Gottesdiener 2002    0         9    6   5 6.686 0.1619320 Etoricoxib_60</span></span>
<span><span class="co">#&gt; 6 Gottesdiener 2002    0        10    6   6 6.854 0.1620282 Etoricoxib_90</span></span>
<span><span class="co">#&gt;   fupcount fups</span></span>
<span><span class="co">#&gt; 1        1    5</span></span>
<span><span class="co">#&gt; 2        1    5</span></span>
<span><span class="co">#&gt; 3        1    5</span></span>
<span><span class="co">#&gt; 4        1    5</span></span>
<span><span class="co">#&gt; 5        1    5</span></span>
<span><span class="co">#&gt; 6        1    5</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 411 rows ]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; studyID :</span></span>
<span><span class="co">#&gt;  [1] "Gottesdiener 2002" "Schnitzer 2005_2"  "Bensen 1999"      </span></span>
<span><span class="co">#&gt;  [4] "DeLemos 2011"      "Gana 2006"         "Kivitz 2001"      </span></span>
<span><span class="co">#&gt;  [7] "Kivitz 2002"       "Fishman 2007"      "Fleischmann 2005" </span></span>
<span><span class="co">#&gt; [10] "Lehmann 2005"      "Schnitzer 2010"    "Sheldon 2005"     </span></span>
<span><span class="co">#&gt; [13] "Tannenbaum 2004"   "Baerwald 2010"     "Bingham 2007a"    </span></span>
<span><span class="co">#&gt; [16] "Bingham 2007b"     "Birbara 2006_1"    "Birbara 2006_2"   </span></span>
<span><span class="co">#&gt; [19] "Enrich 1999"       "Leung 2002"        "Schnitzer 2011LUM"</span></span>
<span><span class="co">#&gt; [22] "Sowers 2005"       "Chappell 2009"     "Chappell 2011"    </span></span>
<span><span class="co">#&gt; [25] "Clegg 2006"        "Markenson 2005"    "McKenna 2001"     </span></span>
<span><span class="co">#&gt; [28] "Puopolo 2007"      "Sawitzke 2010"     "Williams 2001"    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cfb :</span></span>
<span><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; [25] FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; treatments :</span></span>
<span><span class="co">#&gt;  [1] "Pl_0"    "Ce_100"  "Ce_200"  "Ce_400"  "Du_90"   "Et_10"   "Et_30"  </span></span>
<span><span class="co">#&gt;  [8] "Et_5"    "Et_60"   "Et_90"   "Lu_100"  "Lu_200"  "Lu_400"  "Lu_NA"  </span></span>
<span><span class="co">#&gt; [15] "Na_1000" "Na_1500" "Na_250"  "Na_750"  "Ox_44"   "Ro_12"   "Ro_125" </span></span>
<span><span class="co">#&gt; [22] "Ro_25"   "Tr_100"  "Tr_200"  "Tr_300"  "Tr_400"  "Va_10"   "Va_20"  </span></span>
<span><span class="co">#&gt; [29] "Va_5"</span></span></code></pre></div>
<p>This takes a dataset with the columns:</p>
<ul>
<li>
<code>studyID</code> Study identifiers</li>
<li>
<code>time</code> Numeric data indicating continuous follow-up times
(e.g. days, weeks, months)</li>
<li>
<code>y</code> Numeric data indicating the mean response for a given
observation</li>
<li>
<code>se</code> Numeric data indicating the standard error for a
given observation</li>
<li>
<code>treatment</code> Treatment identifiers (can be numeric, factor
or character)</li>
<li>
<code>class</code> An optional column indicating a particular class
that may be shared by several treatments.</li>
<li>
<code>N</code> An optional column indicating the number of
participants used to calculate the response at a given observation.</li>
</ul>
<p>Additional columns can be included in the dataset. These will simply
be added to the <code>mb.network</code> object, though will not affect
the classification of the data.</p>
<p><code>mb.network</code> then performs the following checks on the
data:</p>
<ul>
<li>The dataset has the required column names</li>
<li>There are no missing values</li>
<li>All standard errors (SE) are positive</li>
<li>Observations are made at the same time points in all arms of a study
(i.e. the data are balanced)</li>
<li>Class labels are consistent within each treatment</li>
<li>Studies have at least two arms</li>
</ul>
<p>Unless otherwise specified, <code><a href="../reference/mb.network.html">mb.network()</a></code> will
automatically determine whether each study in the dataset is reported as
change from baseline or absolute - studies that include a measurement at
<code>time=0</code> are assumed to report absolute values, whilst those
with no measurement at <code>time=0</code> are assumed to be change from
baseline. This can also be explicitly specified by the user by including
a logical vector for the argument <code>cfb</code> in
<code><a href="../reference/mb.network.html">mb.network()</a></code> - <code>TRUE</code> indicates a study reports
change from baseline, and <code>FALSE</code> indicates that it reports
absolute values.</p>
<p>Finally, <code><a href="../reference/mb.network.html">mb.network()</a></code> converts the data into an object
of <code>class("mb.network")</code>, which contains indices for study
arms and follow-up measurements, and generates numeric values for
treatments and classes. By convention, treatments are numbered
alphabetically, though if the original data for treatments is provided
as a factor then the factor codes will be used. This then contains all
the necessary information for subsequent <code>MBNMAtime</code>
functions.</p>
<div class="section level3">
<h3 id="network-connectivity">Network connectivity<a class="anchor" aria-label="anchor" href="#network-connectivity"></a>
</h3>
<p>Looking at how the evidence in the network is connected and
identifying which studies compare which treatments helps to understand
which treatment effects can be estimated and what information will be
helping to inform those estimates. A network plot can be generated which
shows which treatments have been compared in head-to-head trials.
Typically the thickness of connecting lines (“edges”) is proportional to
the number of studies that make a particular comparison and the size of
treatment nodes (“vertices”) is proportional to the total number of
patients in the network who were randomised to a given treatment
(provided <code>N</code> is included as a variable in the original
dataset for <code><a href="../reference/mb.network.html">mb.network()</a></code>).</p>
<p>In <code>MBNMAtime</code> these plots are generated using
<code>igraph</code>, and can be plotted by calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.
The generated plots are objects of <code>class("igraph")</code> meaning
that, in addition to the options specified in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>,
various <code>igraph</code> functions can be used to make more detailed
edits to them.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data using the alogliptin dataset</span></span>
<span><span class="va">network.alog</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">alog_pcfb</span>, reference <span class="op">=</span> <span class="st">"placebo"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Studies reporting change from baseline automatically identified from the data</span></span>
<span></span>
<span><span class="co"># Plot network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network.alog</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Within these network plots, treatments are automatically aligned in a
circle (as the default) and can be tidied by shifting the label distance
away from the nodes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw network plot in a star layout using the gout dataset</span></span>
<span><span class="va">network.gout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">goutSUA_CFB</span>, reference <span class="op">=</span> <span class="st">"Plac"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network.gout</span>, layout<span class="op">=</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_as_star.html" class="external-link">as_star</a></span><span class="op">(</span><span class="op">)</span>, label.distance <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Studies reporting change from baseline automatically identified from the data</span></span></code></pre>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>This command returns a warning stating that some treatments are not
connected to the network reference treatment through any pathway of
head-to-head evidence. The nodes that are coloured white represent these
treatments. This means that it will not be possible to estimate relative
effects for these treatments versus the network reference treatment (or
any treatments connected to it). Several options exist to allow for
inclusion of these treatments in an analysis which we will discuss in
more detail later, but one approach is to assume a shared effect among
treatments within the same class/agent. We can generate a network plot
at the class level to examine this more closely, and can see that the
network is connected at the class level.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network.gout</span>, level <span class="op">=</span> <span class="st">"class"</span>, remove.loops <span class="op">=</span> <span class="cn">TRUE</span>, label.distance <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>It is also possible to plot a network at the treatment level but to
colour the treatments by the class that they belong to.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">network.gout</span>, level <span class="op">=</span> <span class="st">"treatment"</span>, v.color <span class="op">=</span> <span class="st">"class"</span>, label.distance <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="examining-the-time-course-relationship">Examining the time-course relationship<a class="anchor" aria-label="anchor" href="#examining-the-time-course-relationship"></a>
</h3>
<p>In order to consider which functional forms may be appropriate for
modeling the time-course relationship, it is important to look at the
responses in each arm plotted over time. This can easily be done using
the <code><a href="../reference/timeplot.html">timeplot()</a></code> function on an object of
<code>class("mb.network")</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data using the pain dataset</span></span>
<span><span class="va">network.pain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">osteopain</span>, reference<span class="op">=</span><span class="st">"Pl_0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Studies reporting change from baseline automatically identified from the data</span></span>
<span></span>
<span><span class="co"># Draw plot of raw study responses over time</span></span>
<span><span class="fu"><a href="../reference/timeplot.html">timeplot</a></span><span class="op">(</span><span class="va">network.pain</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/pain.time-1.png" width="672"></p>
<p>As the mean response for all treatments shows a rapid reduction in
pain score followed by a levelling out after 2-5 weeks, an Integrated
Two-component Prediction (ITP) time-course function might be a
reasonable fit for this dataset. More complex alternatives could be Emax
models (with or without a Hill parameter), fractional polynomials or a
spline function.</p>
<p>Responses can also be plotted grouped by class rather than by
treatment, and the relative effects between each treatment/class can be
plotted instead of the absolute treatment responses. Since the MBNMA
framework models the time-course on relative effects <span class="citation">(Pedder et al. 2019)</span> this can in fact make
interpretation of the plots easier with regards to identifying a
best-fitting time-course function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw plot of within-study relative effects over time grouped by class</span></span>
<span><span class="va">network.gout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">goutSUA_CFBcomb</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/timeplot.html">timeplot</a></span><span class="op">(</span><span class="va">network.gout</span>, level<span class="op">=</span><span class="st">"class"</span>, plotby<span class="op">=</span><span class="st">"rel"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/obese.time-1.png" width="672"></p>
<p>Many of the profiles here appear to be quite different within the
same class, which would suggest modelling class effects may be
inappropriate for this dataset.</p>
<p>Another approach to investigate the time-course relationship is to
perform several standard “lumped” NMAs at different time “bins”, time
periods within which we are assuming treatment effects are constant over
time. This means that, for the purposes of this plot, rather than
considering time as a continuous variable it is chunked up into
segments.</p>
<p>We can do this within a single plot using <code><a href="../reference/binplot.html">binplot()</a></code> and
specifying the boundaries of multiple time bins. Separate NMAs are then
performed within each time bin on data points from studies that fall
within the time bin (only a single follow-up time is taken from each
study to avoid double counting). <code>"fixed"</code> or
<code>"random"</code> effects can be specified for the NMA. Note that
the wider the time bin boundaries specified by the user, the larger the
potential range of included follow-up times and this can introduce
heterogeneity or inconsistency.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot results for NMAs performed between 0-5, 5-10, 10-15 and 15-26 weeks</span></span>
<span><span class="fu"><a href="../reference/binplot.html">binplot</a></span><span class="op">(</span><span class="va">network.pain</span>, overlay.nma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">26</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=0 and time=5</span></span>
<span><span class="co">#&gt; module glm loaded</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=5 and time=10</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=10 and time=15</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=15 and time=26</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/pain.binplot-1.png" width="672"></p>
<p>Results are plotted versus the network reference and are plotted on
the relevant scale depending on the function specified in
<code>link</code> (in this case <code>"identity"</code> - i.e. mean
differences versus Pl_0 are shown). Each time bin window is marked on
the plot by vertical dashed lines. The NMA estimates within each time
bin are plotted as a horizontal solid black line (the posterior median)
with a shaded region indicating the 95% credible interval (prediction
intervals can instead be plotted). The width of these shaded regions is
equal to the range of study time-points included in the NMA performed
within that time-bin, which may therefore be more narrow than the time
bin specified in the <code><a href="../reference/binplot.html">binplot()</a></code> command due to the follow-up
times at which data is available in included studies. For example, for
the time bin between 10-15 weeks, studies from the dataset included in
this time bin have follow-ups between 12-13 weeks.</p>
<p>From this plot we can see that, whilst there clearly is a rapid onset
of treatment efficacy within the first 5 weeks, indicated by a treatment
effect &lt;0 for most treatments. This treatment effect then persists
and remains more or less constant for some treatments within later time
bins, though for others (e.g. Ce_200, Ro_25, Na_1000, Na_1500, Va_10)
there appears to be a loss of efficacy for later time bins, suggesting a
more complex time-course function may be required to fully capture this
relationship.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-using-mb-run">Analysis using <code>mb.run()</code><a class="anchor" aria-label="anchor" href="#analysis-using-mb-run"></a>
</h2>
<p>MBNMA models are fitted using <code><a href="../reference/mb.run.html">mb.run()</a></code> and they model
treatment effects over time (e.g. days, weeks, months). This can just as
easily be performed on datasets with many different treatments (network
meta-analysis) as it can on datasets comparing only two treatments
(pairwise meta-analysis) - the syntax is the same.</p>
<p>An object or <code>class("mb.network")</code> must be provided as the
data for <code><a href="../reference/mb.run.html">mb.run()</a></code>. The key arguments within
<code><a href="../reference/mb.run.html">mb.run()</a></code> involve specifying the functional form used to
model the time-course, and the time-course parameters that comprise that
functional form.</p>
<div class="section level3">
<h3 id="time-course-functions">Time-course functions<a class="anchor" aria-label="anchor" href="#time-course-functions"></a>
</h3>
<p>A number of different time-course functions can be fitted within
<code>MBNMAtime</code> and the specific forms of the time-course
parameters are defined by arguments within these functions, and this
allows for a wide variety of parameterizations and time-course
shapes.</p>
<p>For further details check the help files for each function
(e.g. <code>?tloglin()</code>). These functions, are then used as inputs
for the <code>fun</code> argument in <code><a href="../reference/mb.run.html">mb.run()</a></code>.</p>
<ul>
<li>
<code><a href="../reference/tloglin.html">tloglin()</a></code> - Log-linear function</li>
<li>
<code><a href="../reference/titp.html">titp()</a></code> - Integrated Two-Component Prediction (ITP)
function</li>
<li>
<code><a href="../reference/temax.html">temax()</a></code> - Emax function</li>
<li>
<code><a href="../reference/tpoly.html">tpoly()</a></code> - Polynomial function (e.g. linear,
quadratic)</li>
<li>
<code><a href="../reference/tfpoly.html">tfpoly()</a></code> - Fractional polynomial function, as proposed
previously for time-course NMA by Jansen <span class="citation">(2015)</span>.</li>
<li>
<code><a href="../reference/tspline.html">tspline()</a></code> - Spline functions (includes B-splines,
restricted cubic splines, natural splines and piecewise linear
splines)</li>
<li>
<code><a href="../reference/tuser.html">tuser()</a></code> - A time-course function that can be explicitly
defined by the user</li>
</ul>
<p>Time-course parameters within time-course functions are each defined
by two arguments:</p>
<p><code>pool</code> is used to define the approach used for the pooling
of a given time-course parameter and can either of:</p>
<ul>
<li>
<code>"rel"</code> indicates that relative effects (or mean
differences) should be pooled for this time-course parameter. This
preserves randomisation within included studies, are likely to vary less
between studies (only due to effect modification), and allow for testing
of consistency between direct and indirect evidence. Pooling follows the
general approach for Network Meta-Analysis proposed by Lu and Ades <span class="citation">(2004)</span>.</li>
<li>
<code>"abs"</code> indicates that study arms should be pooled across
the whole network for this time-course parameter <strong>independently
of assigned treatment</strong>. This implies using a single absolute
value across the network for this time-course parameter, and may
therefore be making strong assumptions of similarity between
studies.</li>
</ul>
<p><code>method</code> is used to define the model used for
meta-analysis for a given time-course parameter and can take either
of:</p>
<ul>
<li>
<code>"common"</code> implies that all studies estimate the same
true effect (sometimes called a “fixed effect” meta-analysis)</li>
<li>
<code>"random"</code> implies that all studies estimate a separate
true effect, but that each of these true effects vary randomly around a
true mean effect. This approach allows for modelling of between-study
heterogeneity.</li>
</ul>
<p>Specifying pooling relative effects on all time-course parameters
would imply performing a contrast-based synthesis, whereas specifying
pooling absolute effects on all of them would imply performing an
arm-based synthesis. There has been substantial discussion in the
literature regarding the strengths and limitations of both these
approaches <span class="citation">(Dias and Ades 2016; Hong et al. 2016;
Karahalios et al. 2017)</span>.</p>
<p>Additional arguments within the function may also be used to specify
the degree (e.g. for polynomials) or the number of knots or knot
placement for splines.</p>
<div class="section level4">
<h4 id="choosing-a-time-course-function">Choosing a time-course function<a class="anchor" aria-label="anchor" href="#choosing-a-time-course-function"></a>
</h4>
<p>Choice of time-course function involves a combination of data-driven,
statistical information (plots, model fit statistics) and
clinical/biological plausibility. <code><a href="../reference/timeplot.html">timeplot()</a></code> and
<code><a href="../reference/binplot.html">binplot()</a></code> functions can be used to observe the how the data
differs at different time-points. This can help to understand, for
example, whether the data monotonically increases or decreases, or
whether there is a turning point or multiple turning-points within the
time-course, and at which follow-up time(s) this might occur. This can
also be guided by a clinical/biological knowledge/expectation of the
shape of the time-course outside of the range of time-points for which
data are available.</p>
<p>However, once several potential candidate time-course functions have
been identified, selection between them (and of the specific
specification of the time-course parameters in terms of absolute or
relative effects) is best achieved using model fit statistics
(e.g. Deviance Information Criterion (DIC), residual deviance).</p>
</div>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p><code><a href="../reference/mb.run.html">mb.run()</a></code> returns an object of
<code>class(c("mbnma", "rjags"))</code>. <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> provides
summary estimates of posterior densities for different parameters in the
model, with some explanation regarding the way in which the model has
been defined. Estimates are automatically reported for parameters of
interest depending on the model specification (unless otherwise
specified in <code>parameters.to.save</code>). Nodes that are
automatically monitored (if present in the model) have the following
interpretation:</p>
<div class="section level4">
<h4 id="parameters-modelled-using-relative-effects">Parameters modelled using relative effects<a class="anchor" aria-label="anchor" href="#parameters-modelled-using-relative-effects"></a>
</h4>
<p>If pooling is relative (e.g. <code>pool.1="rel"</code>) for a given
parameter then the named parameter (e.g. <code>emax</code>) or a
numbered <code>d</code> parameter (e.g. <code>d.1</code>) corresponds to
the pooled relative effect (or mean difference) for a given treatment
compared to the network reference treatment for this time-course
parameter.</p>
<p><code>sd.</code> followed by a named (e.g. <code>emax</code>,
<code>beta.1</code>) is the between-study SD (heterogeneity) for
relative effects, reported if pooling for a time-course parameter is
relative (e.g. <code>pool.1="rel"</code>) <em>and</em> the method for
synthesis is random (e.g. <code>method.1="random</code>).</p>
<p>If class effects are modelled, parameters for classes are represented
by the upper case name of the time-course parameter they correspond to.
For example if <code>class.effect=list(emax="random")</code>, relative
class effects will be represented by <code>EMAX</code>. The SD of the
class effect (e.g. <code>sd.EMAX</code>, <code>sd.BETA.1</code>) is the
SD of treatments within a class for the time-course parameter they
correspond to.</p>
</div>
<div class="section level4">
<h4 id="parameters-modelled-using-absolute-effects">Parameters modelled using absolute effects<a class="anchor" aria-label="anchor" href="#parameters-modelled-using-absolute-effects"></a>
</h4>
<p>If pooling is absolute (e.g. <code>pool.1="abs"</code>) for a given
parameter then the named parameter (e.g. <code>emax</code>) or a
numbered <code>beta</code> parameter (e.g. <code>beta.1</code>)
corresponds to the estimated absolute effect for this time-course
parameter.</p>
<p>For an absolute time-course parameter if the corresponding method is
common (e.g. <code>method.1="common"</code>) the parameter corresponds
to a single common parameter estimated across all studies and
treatments. If the corresponding method is random
(e.g. <code>method.1="random"</code>) then parameter is a mean effect
around which the study-level absolute effects vary with SD corresponding
to <code>sd.</code> followed by the named parameter
(e.g. <code>sd.emax</code>, <code>sd.beta.1</code>).</p>
</div>
<div class="section level4">
<h4 id="other-model-parameters">Other model parameters<a class="anchor" aria-label="anchor" href="#other-model-parameters"></a>
</h4>
<p><code>rho</code> is the correlation coefficient for correlation
between time-points. Its interpretation will differ depending on the
covariance structure specified in <code>covar</code>.</p>
<p><code>totresdev</code> is residual deviance of the model and
<code>deviance</code> is the deviance of the model. Model fit statistics
for <code>pD</code> (effective number of parameters) and
<code>DIC</code> (Deviance Information Criterion) are also reported,
with an explanation as to how they have been calculated.</p>
</div>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<p>An example MBNMA of the alogliptin dataset using a linear time-course
function and common treatment effects that pool relative effects and
assumes consistency between direct and indirect evidence can be
performed as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run a linear time-course MBNMA</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.alog</span>, fun<span class="op">=</span><span class="fu"><a href="../reference/tpoly.html">tpoly</a></span><span class="op">(</span>degree<span class="op">=</span><span class="fl">1</span>, pool.1<span class="op">=</span><span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Change from version 0.2.2 onwards: corparam=FALSE as default</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbnma</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Time-course MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Time-course function: poly (degree = 1)</span></span>
<span><span class="co">#&gt; Data modelled without intercept (change from baseline data assumed)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 parameter</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects</span></span>
<span><span class="co">#&gt; Method: common treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:---------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |placebo   |d.1[1]    |  0.0000|  0.0000|  0.0000|</span></span>
<span><span class="co">#&gt; |alog_6.25 |d.1[2]    | -0.0347| -0.0375| -0.0318|</span></span>
<span><span class="co">#&gt; |alog_12.5 |d.1[3]    | -0.0422| -0.0440| -0.0405|</span></span>
<span><span class="co">#&gt; |alog_25   |d.1[4]    | -0.0450| -0.0467| -0.0432|</span></span>
<span><span class="co">#&gt; |alog_50   |d.1[5]    | -0.0512| -0.0539| -0.0484|</span></span>
<span><span class="co">#&gt; |alog_100  |d.1[6]    | -0.0480| -0.0663| -0.0294|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Correlation between time points</span></span></span>
<span><span class="co">#&gt; Covariance structure: varadj </span></span>
<span><span class="co">#&gt; Rho assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">#### Model Fit Statistics ####</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD (pV) calculated using the rule, pD = var(deviance)/2 = 18</span></span>
<span><span class="co">#&gt; Deviance = 4502</span></span>
<span><span class="co">#&gt; Residual deviance = 5449</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 4520</span></span></code></pre></div>
<p>For this model, the <code>d.1</code> parameters correspond to the 1st
polynomial coefficient, and therefore are the linear gradient of the
response over time for each treatment versus <code>placebo</code> -
i.e. the mean difference for the change in efficacy for each treatment
versus <code>placebo</code>. However, note that the residual deviance of
the model is very high, suggesting (as we might expect) that this linear
time-course function is a poor fit.</p>
<p>We may want to fit a more complex time-course function with two
time-course parameters, such as an Emax function, yet limitations in the
data might require that we make an assumption that one of the parameters
does not vary by treatment. We can specify this by setting
<code>pool</code> to be equal to <code>"abs"</code> for any parameters
we choose.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run an Emax time-course MBNMA with two parameters</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.alog</span>, fun<span class="op">=</span><span class="fu"><a href="../reference/temax.html">temax</a></span><span class="op">(</span></span>
<span>  pool.emax <span class="op">=</span> <span class="st">"rel"</span>, method.emax<span class="op">=</span><span class="st">"common"</span>,</span>
<span>  pool.et50 <span class="op">=</span> <span class="st">"abs"</span>, method.et50<span class="op">=</span><span class="st">"common"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'et50' parameters must take positive values.</span></span>
<span><span class="co">#&gt;  Default half-normal prior restricts posterior to positive values.</span></span>
<span><span class="co">#&gt; Change from version 0.2.2 onwards: corparam=FALSE as default</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbnma</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Time-course MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Time-course function: emax</span></span>
<span><span class="co">#&gt; Data modelled without intercept (change from baseline data assumed)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">emax parameter</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects</span></span>
<span><span class="co">#&gt; Method: common treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |Parameter |  Median|    2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:---------|:---------|-------:|-------:|-------:|</span></span>
<span><span class="co">#&gt; |placebo   |emax[1]   |  0.0000|  0.0000|  0.0000|</span></span>
<span><span class="co">#&gt; |alog_6.25 |emax[2]   | -0.5887| -0.6510| -0.5218|</span></span>
<span><span class="co">#&gt; |alog_12.5 |emax[3]   | -0.7763| -0.8162| -0.7366|</span></span>
<span><span class="co">#&gt; |alog_25   |emax[4]   | -0.8461| -0.8878| -0.8040|</span></span>
<span><span class="co">#&gt; |alog_50   |emax[5]   | -0.9660| -1.0353| -0.8999|</span></span>
<span><span class="co">#&gt; |alog_100  |emax[6]   | -0.8306| -1.0900| -0.5682|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">et50 parameter</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: absolute effects</span></span>
<span><span class="co">#&gt; Method: common treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |Parameter | Median|   2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:---------|:---------|------:|------:|------:|</span></span>
<span><span class="co">#&gt; |placebo   |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; |alog_6.25 |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; |alog_12.5 |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; |alog_25   |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; |alog_50   |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; |alog_100  |et50      | 5.1951| 4.8124| 5.6053|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Correlation between time points</span></span></span>
<span><span class="co">#&gt; Covariance structure: varadj </span></span>
<span><span class="co">#&gt; Rho assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">#### Model Fit Statistics ####</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD (pV) calculated using the rule, pD = var(deviance)/2 = 20</span></span>
<span><span class="co">#&gt; Deviance = 87</span></span>
<span><span class="co">#&gt; Residual deviance = 1034</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 107</span></span></code></pre></div>
<p>In this case, the parameters are named following the Emax function
specification. <code>emax</code> corresponds to the maximum effect for
each treatment versus <code>placebo</code> (interpretable as a mean
difference versus <code>placebo</code>), whereas <code>et50</code> is
the log of the time at which 50% of the maximum response is achieved,
<strong>across all treatments in the network</strong>. This assumes
conditional constancy of absolute effects for this time-course
parameter, which is typically a strong assumption. However, if there
were limited data with which to inform this parameter (e.g. at earlier
time-points) then such an assumption might be necessary, with the caveat
that interpolation of response at time-points informed by this parameter
may be more susceptible to bias. Further exploration of the degree of
data required for reliable estimation of time-course parameters is given
in Pedder et al. <span class="citation">(2020)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="additional-model-specification-with-mb-run">Additional model specification with <code>mb.run()</code><a class="anchor" aria-label="anchor" href="#additional-model-specification-with-mb-run"></a>
</h3>
<div class="section level4">
<h4 id="correlation-between-time-points">Correlation between time points<a class="anchor" aria-label="anchor" href="#correlation-between-time-points"></a>
</h4>
<p>Within-study correlation between time points can easily be modeled
using <code><a href="../reference/mb.run.html">mb.run()</a></code>, though this requires some additional
considerations. The simplest approach is to incorporate correlation by
using a variance adjustment <span class="citation">(Jansen, Vieira, and
Cope 2015)</span>. This avoids the need to use a multivariate normal
likelihood (which is slow to run), and it assumes a common correlation
between neighbouring time-points. This is achieved by using the argument
<code>covar="varadj"</code>, which is the default in
<code><a href="../reference/mb.run.html">mb.run()</a></code>.</p>
<p>There are two alternative covariance structures can be modelled,
though these require fitting a multivariate normal likelihood and
therefore take longer to run. <code>covar="CS"</code> specifies fitting
a Compound Symmetry covariance structure, whilst
<code>covar="AR1"</code> specifies fitting an autoregressive AR1
covariance structure to the multivariate normal likelihood used for
modelling the correlation between multiple time points within a study
<span class="citation">(Kincaid 2005)</span>.</p>
<p>However, in addition to this, it’s also necessary to specify a value
for <code>rho</code>, and this can be assigned in one of two ways:</p>
<ul>
<li>Given as string representing a JAGS prior distribution <span class="citation">(Plummer 2017)</span>, which indicates that the
correlation should be estimated from the data. For example, to specify a
prior that the correlation between time-points will be between 0 and 1
with equal probability you could set <code>rho="dunif(0,1)"</code>.</li>
<li>Given as a single numeric value, which indicates that the
correlation should be fixed to that value. For example, this value could
be estimated externally from another study using Individual Participant
Data. This could also be used to run a deterministic sensitivity
analysis using different fixed values of <code>rho</code>.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the COPD dataset</span></span>
<span><span class="va">network.copd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">copd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run an log-linear time-course MBNMA </span></span>
<span><span class="co"># that accounts for correlation between time points using variance adjustment</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.copd</span>, </span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tloglin.html">tloglin</a></span><span class="op">(</span>pool.rate<span class="op">=</span><span class="st">"rel"</span>, method.rate<span class="op">=</span><span class="st">"random"</span><span class="op">)</span>,</span>
<span>                rho<span class="op">=</span><span class="st">"dunif(0,1)"</span>, covar<span class="op">=</span><span class="st">"varadj"</span><span class="op">)</span></span></code></pre></div>
<p>It is important to note that the covariance matrix must be positive
semi-definite. This may mean that in order to satisfy this requirement
for particular covariance matrix structures, the values that
<code>rho</code> can take are limited. <code>rho</code> must always be
bounded by -1 and 1, but even within this range some negative values for
<code>rho</code> can result in a non positive matrix, which can lead to
an error in the evaluation of the multivariate likelihood. If so, it may
be necessary to further restrict the prior distribution.</p>
</div>
</div>
<div class="section level3">
<h3 id="link-function">Link function<a class="anchor" aria-label="anchor" href="#link-function"></a>
</h3>
<p>Time-course MBNMA can only be used for continuous outcomes <em>or
those that can be summarised as continuous outcomes</em> (e.g. binary
data can be converted to log-odds for inclusion in the model). Typically
this means that users will analyse data using an identity link function,
the default given to the <code>link</code> argument in
<code><a href="../reference/mb.run.html">mb.run()</a></code>m which assumes an additive treatment effect
(e.g. mean difference).</p>
<p>However, by specifying <code>link="log"</code> a user can model a log
link and therefore assume a multiplicative treatment effect. For
continuous data this models the treatment effect as a Ratio of Means
(RoM) <span class="citation">(Friedrich, Adhikari, and Beyene
2011)</span>. This also provides an advantage as the treatment effect is
scale independent (i.e. studies measuring the same outcome using
different measurement scales can be analysed simultaneously). However,
within-study treatment effects must all be of the same direction (either
positive or negative), and change from baseline measures must be
adjusted so that they are also expressed as RoMs (log(follow-up) -
log(baseline)) to avoid combining additive and multiplicative
assumptions within the same analysis.</p>
<p>An alternative approach for modeling a measurement scale-independent
treatment effect whilst still assuming additive treatment effects is to
perform the analysis using Standardised Mean Differences (SMD). Whilst
not strictly a different link function, this can be specified using
<code>link="smd"</code>. Currently, <code>MBNMAtime</code> standardises
treatment effects using the pooled baseline standard deviation (SD) in
each study, to limit bias from any effect the treatment might have on
SD. The resulting treatment effects are reported in units of SD as
SMDs.</p>
<p>A more robust approach to minimise bias from estimation of
within-study SD would be to use a single reference SD for
standardisation of each scale included in the dataset. This is something
<code>MBNMAtime</code> will incorporate in the future. For further
details of analysis of continuous data that include discussion of both
RoM and SMD see <span class="citation">(Daly et al. 2021)</span>.</p>
</div>
<div class="section level3">
<h3 id="class-effects">Class effects<a class="anchor" aria-label="anchor" href="#class-effects"></a>
</h3>
<p>Shared effects between treatments within the network can be modelled
using class effects. This requires assuming that different treatments
have some sort of shared class effect, perhaps due to different (yet
clinically similar) doses of the same agent or different treatments with
a similar mechanism of action. One advantage of this is that class
effects can be used to connect relative effects between treatments in a
network that would be disconnected at the treatment level, but can be
connected via classes at the class level. However, it is important to
ensure that such an effect is clinically justifiable, as making these
assumptions risks introducing heterogeneity/inconsistency.</p>
<p>Class effects can only be applied to time-course parameters which
vary by treatment (<code>pool="rel"</code>), and class effects are
modelled separately for each time-course parameter.</p>
<p>In <code><a href="../reference/mb.run.html">mb.run()</a></code> class effects are specified as a list, in
which each element is named by the time-course parameter on which it
should be modelled. The class effect for each time-course parameter can
be either <code>"common"</code>, in which the effects for each treatment
within the same class are constrained to a common class effect, or
<code>"random"</code>, in which the effects for each treatment within
the same class are assumed to be randomly distributed around a shared
class mean.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run a B-spline time-course MBNMA with a knot at 0.2 times the max follow-up</span></span>
<span><span class="co"># Common class effect on beta.2, the 2nd spline coefficient</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.gout</span>, </span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"bs"</span>, knots<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2<span class="op">=</span><span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"random"</span><span class="op">)</span>,</span>
<span>                class.effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta.2<span class="op">=</span><span class="st">"common"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbnma</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Time-course MBNMA</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Time-course function: B-spline (knots = 0.2; degree = 1)</span></span>
<span><span class="co">#&gt; Data modelled without intercept (change from baseline data assumed)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.1 parameter</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects</span></span>
<span><span class="co">#&gt; Method: common treatment effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |Parameter |   Median|     2.5%|    97.5%|</span></span>
<span><span class="co">#&gt; |:---------|:---------|--------:|--------:|--------:|</span></span>
<span><span class="co">#&gt; |Plac      |d.1[1]    |   0.0000|   0.0000|   0.0000|</span></span>
<span><span class="co">#&gt; |Allo_100  |d.1[2]    |  -1.4472|  -2.9360|   0.0171|</span></span>
<span><span class="co">#&gt; |Allo_200  |d.1[3]    |  -3.0027|  -3.2531|  -2.7409|</span></span>
<span><span class="co">#&gt; |Allo_289  |d.1[4]    |  -4.9128|  -5.0807|  -4.7363|</span></span>
<span><span class="co">#&gt; |Allo_400  |d.1[5]    | -12.7764| -14.3098| -11.1875|</span></span>
<span><span class="co">#&gt; |Arha_NA   |d.1[6]    |  -6.8466|  -7.5645|  -6.1419|</span></span>
<span><span class="co">#&gt; |BCX4_140  |d.1[7]    |  -4.5826|  -4.9719|  -4.2022|</span></span>
<span><span class="co">#&gt; |BCX4_18.5 |d.1[8]    |  -2.4523|  -2.8964|  -2.0233|</span></span>
<span><span class="co">#&gt; |BCX4_240  |d.1[9]    |  -5.9029|  -6.3469|  -5.4454|</span></span>
<span><span class="co">#&gt; |BCX4_80   |d.1[10]   |  -3.6030|  -4.0833|  -3.1532|</span></span>
<span><span class="co">#&gt; |Benz_NA   |d.1[11]   | -15.5706| -16.7808| -14.3554|</span></span>
<span><span class="co">#&gt; |Febu_140  |d.1[12]   |  -7.2863|  -7.4577|  -7.1051|</span></span>
<span><span class="co">#&gt; |Febu_210  |d.1[13]   |  -8.8142|  -8.9129|  -8.7113|</span></span>
<span><span class="co">#&gt; |Febu_25   |d.1[14]   |  -3.8383|  -4.0040|  -3.6678|</span></span>
<span><span class="co">#&gt; |Febu_72.5 |d.1[15]   |  -6.1725|  -6.3433|  -5.9939|</span></span>
<span><span class="co">#&gt; |RDEA_100  |d.1[16]   |  -2.3557|  -2.9007|  -1.7836|</span></span>
<span><span class="co">#&gt; |RDEA_200  |d.1[17]   |  -4.1231|  -4.4573|  -3.7675|</span></span>
<span><span class="co">#&gt; |RDEA_400  |d.1[18]   |  -5.2451|  -5.5685|  -4.9123|</span></span>
<span><span class="co">#&gt; |RDEA_600  |d.1[19]   |  -8.0920|  -8.5255|  -7.6443|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">beta.2 parameter</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span>Pooling: relative effects</span></span>
<span><span class="co">#&gt; Method: random treatment effects</span></span>
<span><span class="co">#&gt; Class effects modelled for this parameter</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |Parameter |  Median|     2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:---------|:---------|-------:|--------:|-------:|</span></span>
<span><span class="co">#&gt; |Plac      |d.2[1]    |  0.0000|   0.0000|  0.0000|</span></span>
<span><span class="co">#&gt; |Allo_100  |d.2[2]    | 17.4547|   4.5731| 30.2793|</span></span>
<span><span class="co">#&gt; |Allo_200  |d.2[3]    | 17.4547|   4.5731| 30.2793|</span></span>
<span><span class="co">#&gt; |Allo_289  |d.2[4]    | 17.4547|   4.5731| 30.2793|</span></span>
<span><span class="co">#&gt; |Allo_400  |d.2[5]    | 17.4547|   4.5731| 30.2793|</span></span>
<span><span class="co">#&gt; |Arha_NA   |d.2[6]    | -0.0980| -61.5672| 60.9292|</span></span>
<span><span class="co">#&gt; |BCX4_140  |d.2[7]    |  9.8901|  -2.0123| 23.1189|</span></span>
<span><span class="co">#&gt; |BCX4_18.5 |d.2[8]    |  9.8901|  -2.0123| 23.1189|</span></span>
<span><span class="co">#&gt; |BCX4_240  |d.2[9]    |  9.8901|  -2.0123| 23.1189|</span></span>
<span><span class="co">#&gt; |BCX4_80   |d.2[10]   |  9.8901|  -2.0123| 23.1189|</span></span>
<span><span class="co">#&gt; |Benz_NA   |d.2[11]   | 18.1999|  -7.1332| 42.4594|</span></span>
<span><span class="co">#&gt; |Febu_140  |d.2[12]   | 16.1208|   5.5239| 26.8551|</span></span>
<span><span class="co">#&gt; |Febu_210  |d.2[13]   | 16.1208|   5.5239| 26.8551|</span></span>
<span><span class="co">#&gt; |Febu_25   |d.2[14]   | 16.1208|   5.5239| 26.8551|</span></span>
<span><span class="co">#&gt; |Febu_72.5 |d.2[15]   | 16.1208|   5.5239| 26.8551|</span></span>
<span><span class="co">#&gt; |RDEA_100  |d.2[16]   | 20.6809|   3.5340| 36.9378|</span></span>
<span><span class="co">#&gt; |RDEA_200  |d.2[17]   | 20.6809|   3.5340| 36.9378|</span></span>
<span><span class="co">#&gt; |RDEA_400  |d.2[18]   | 20.6809|   3.5340| 36.9378|</span></span>
<span><span class="co">#&gt; |RDEA_600  |d.2[19]   | 20.6809|   3.5340| 36.9378|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Between-study SD modelled for this parameter:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Parameter |  Median|   2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:---------|-------:|------:|-------:|</span></span>
<span><span class="co">#&gt; |sd.beta.2 | 11.8597| 9.2186| 15.4196|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Class Effects</span></span></span>
<span><span class="co"><span style="font-weight: bold; text-decoration: underline;">#&gt; </span></span></span>
<span><span class="co">#&gt; Class effects for beta.2</span></span>
<span><span class="co">#&gt; Common (fixed) class effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Class |Parameter |  Median|     2.5%|   97.5%|</span></span>
<span><span class="co">#&gt; |:-----|:---------|-------:|--------:|-------:|</span></span>
<span><span class="co">#&gt; |Plac  |D.2[1]    |  0.0000|   0.0000|  0.0000|</span></span>
<span><span class="co">#&gt; |Allo  |D.2[2]    | 17.4547|   4.5731| 30.2793|</span></span>
<span><span class="co">#&gt; |Arha  |D.2[3]    | -0.0980| -61.5672| 60.9292|</span></span>
<span><span class="co">#&gt; |BCX4  |D.2[4]    |  9.8901|  -2.0123| 23.1189|</span></span>
<span><span class="co">#&gt; |Benz  |D.2[5]    | 18.1999|  -7.1332| 42.4594|</span></span>
<span><span class="co">#&gt; |Febu  |D.2[6]    | 16.1208|   5.5239| 26.8551|</span></span>
<span><span class="co">#&gt; |RDEA  |D.2[7]    | 20.6809|   3.5340| 36.9378|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">Correlation between time points</span></span></span>
<span><span class="co">#&gt; Covariance structure: varadj </span></span>
<span><span class="co">#&gt; Rho assigned a numeric value: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">#### Model Fit Statistics ####</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; Effective number of parameters:</span></span>
<span><span class="co">#&gt; pD (pV) calculated using the rule, pD = var(deviance)/2 = 85</span></span>
<span><span class="co">#&gt; Deviance = 149881</span></span>
<span><span class="co">#&gt; Residual deviance = 150575</span></span>
<span><span class="co">#&gt; Deviance Information Criterion (DIC) = 149965</span></span></code></pre></div>
<p>Mean class effects are given in the output as <code>D.2</code>
parameters. These can be interpreted as the relative effect of each
class versus the <code>Plac</code> (Placebo), for the 2nd spline
coefficient (<code>beta.2</code>). Note the number of <code>D.2</code>
parameters is therefore equal to the number of classes defined in the
dataset.</p>
</div>
<div class="section level3">
<h3 id="additional-arguments">Additional arguments<a class="anchor" aria-label="anchor" href="#additional-arguments"></a>
</h3>
<p>Several additional arguments can be given to <code><a href="../reference/mb.run.html">mb.run()</a></code>
that require further explanation.</p>
<div class="section level4">
<h4 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h4>
<p>Default vague priors for the model are as follows:</p>
<p><span class="math display">\[
\begin{aligned}
  &amp;\alpha_{i} \sim N(0,10000)\\
  &amp;\boldsymbol{\mu}_{i} \sim N(0,10000)\\
  &amp;\boldsymbol{d}_{t} \sim N(0,10000)\\
  &amp;beta_{\phi} \sim N(0,10000)\\
  &amp;D_{\phi,c} \sim N(0,1000)\\
  &amp;\tau_{\phi} \sim N(0,400) \text{  limited to  } x \in
[0,\infty]\\
  &amp;\tau^D_{\phi} \sim N(0,400) \text{ limited to } x \in
[0,\infty]\\
\end{aligned}
\]</span></p>
<ul>
<li>
<span class="math inline">\(\alpha_i\)</span> is the response at
time=0 in study <span class="math inline">\(i\)</span>
</li>
<li>
<span class="math inline">\(\mu_i\)</span> is a vector of study
reference effects for each time-course parameter in study <span class="math inline">\(i\)</span>. Where only a single time-course
parameter is modelled using relative effects the prior is defined as
<span class="math inline">\(\mu_{i} \sim N(0,10000)\)</span>.</li>
<li>
<span class="math inline">\(\boldsymbol{d}_{t}\)</span> is a vector
of pooled relative effects for treatment <span class="math inline">\(t\)</span> whose length is the number of
time-course parameters in the model. Where only a single time-course
parameter is modelled using relative effects the prior is defined as
<span class="math inline">\(d_{t} \sim N(0,10000)\)</span>.</li>
<li>
<span class="math inline">\(\beta_{\phi}\)</span> is the absolute
effect for time-course parameter <span class="math inline">\(\phi\)</span> modelled independently of
treatment</li>
<li>
<span class="math inline">\(D_{\phi,c}\)</span> is the class
relative effect for time-course parameter <span class="math inline">\(\phi\)</span> in class <span class="math inline">\(c\)</span>
</li>
<li>
<span class="math inline">\(\tau_{\phi}\)</span> is the
between-study SD for time-course parameter <span class="math inline">\(\phi\)</span>
</li>
<li>
<span class="math inline">\(\tau^D_{\phi}\)</span> is the
within-class SD for time-course parameter <span class="math inline">\(\phi\)</span>
</li>
</ul>
<p>Users may wish to change these, perhaps in order to use more/less
informative priors, but also because the default prior distributions in
some models may lead to errors when compiling/updating models.</p>
<p>This can be more likely for certain types of models. For example some
prior distributions may generate results that are too extreme for JAGS
to compute, such as for time-course parameters that are powers
(e.g. Emax functions with a Hill parameter or power parameters in
fractional polynomials).</p>
<p>If the model fails during compilation/updating (i.e. due to a problem
in JAGS), <code><a href="../reference/mb.run.html">mb.run()</a></code> will generate an error and return a list
of arguments that <code><a href="../reference/mb.run.html">mb.run()</a></code> used to generate the model.
Within this (as within a model that has run successfully), the priors
used by the model (in JAGS syntax) are stored within
<code>"model.arg"</code>.</p>
<p>In this way a model can first be run with vague priors and then rerun
with different priors, perhaps to allow successful computation, perhaps
to provide more informative priors, or perhaps to run a sensitivity
analysis with different priors.</p>
<p>To change priors within a model, a list of replacements can be
provided to <code>priors</code> in <code><a href="../reference/mb.run.html">mb.run()</a></code>. The name of
each element is the name of the parameter to change (without indices)
and the value of the element is the JAGS distribution to use for the
prior. See the JAGS Manual <span class="citation">(2017)</span> for
syntax details regarding specifying distributions. This can include
censoring or truncation if desired. Only the priors to be changed need
to be specified - priors for parameters that aren’t specified will take
default values. Note that in JAGS, normal distributions are specified
using precision (1/variance) rather than SD.</p>
<p>For example, we may wish to specify a tighter prior for the
between-study SD:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.copd</span>, </span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tloglin.html">tloglin</a></span><span class="op">(</span>pool.rate<span class="op">=</span><span class="st">"rel"</span>, method.rate<span class="op">=</span><span class="st">"random"</span><span class="op">)</span>,</span>
<span>                priors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate<span class="op">=</span><span class="st">"dnorm(0,2) T(0,)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pd-effective-number-of-parameters">pD (effective number of parameters)<a class="anchor" aria-label="anchor" href="#pd-effective-number-of-parameters"></a>
</h4>
<p>The default value for <code>pd</code> in <code><a href="../reference/mb.run.html">mb.run()</a></code> is
<code>pd="pv"</code>, which uses the rapid approach automatically
calculated in the <code>R2jags</code> package as
<code>pv = var(deviance)/2</code>. Whilst this is easy to calculate, it
is only an approximation to the effective number of parameters, and may
be numerically unstable <span class="citation">(Gelman et al.
2003)</span>. However, it has been shown to be reliable for model
comparison in time-course MBNMA models in a simulation study <span class="citation">(Pedder et al. 2020)</span>.</p>
<p>A more reliable method for estimating <code>pd</code> is
<code>pd="pd.kl"</code>, which uses the Kullback-Leibler divergence
<span class="citation">(Plummer 2008)</span>. This is more reliable than
the default method used in <code>R2jags</code> for calculating the
effective number of parameters from non-linear models. The disadvantage
of this approach is that it requires running additional MCMC iterations,
so can be slightly slower to calculate.</p>
<p>A commonly-used approach in Bayesian models for calculating pD is the
plug-in method (<code>pd="plugin"</code>) <span class="citation">(Spiegelhalter et al. 2002)</span>. However, this can
sometimes result in negative non-sensical values due to skewed posterior
distributions for deviance contributions that can arise when fitting
non-linear models.</p>
<p>Finally, pD can also be calculated using an optimism adjustment
(<code>pd="popt"</code>) which allows for calculation of the penalized
expected deviance <span class="citation">(Plummer 2008)</span>. This
adjustment allows for the fact that data used to estimate the model is
the same as that used to assess its parsimony. As for
<code>pd="pd.kl"</code>, it also requires running additional MCMC
iterations.</p>
</div>
<div class="section level4">
<h4 id="correlation-between-time-course-parameters">Correlation between time-course parameters<a class="anchor" aria-label="anchor" href="#correlation-between-time-course-parameters"></a>
</h4>
<p>Since MBNMAtime version 0.2.2, <code><a href="../reference/mb.run.html">mb.run()</a></code> no longer
automatically models correlation between time-course parameters modeled
using relative effects.</p>
<p>However, this can be enabled by setting <code>corparam=TRUE</code>).
Time-course parameters are typically correlated and this allows
information on each parameter to help inform the other(s). The
correlation is modeled using a multivariate normal distribution whose
covariance matrix <span class="math inline">\(\Sigma_t\)</span> is
modelled using a correlation defined by the parameter
<code>rhoparam</code>. In previous versions, an inverse Wishart prior
was used, though this has since been considered to overly constrain the
model.</p>
</div>
<div class="section level4">
<h4 id="arguments-to-be-sent-to-jags">Arguments to be sent to JAGS<a class="anchor" aria-label="anchor" href="#arguments-to-be-sent-to-jags"></a>
</h4>
<p>In addition to the arguments specific to <code><a href="../reference/mb.run.html">mb.run()</a></code> it is
also possible to use any arguments to be sent to
<code><a href="https://rdrr.io/pkg/R2jags/man/jags.html" class="external-link">R2jags::jags()</a></code>. Most of these relate to improving the
performance of MCMC simulations in JAGS. Some of the key arguments that
may be of interest are:</p>
<ul>
<li>
<code>n.chains</code> The number of Markov chains to run (default is
3)</li>
<li>
<code>n.iter</code> The total number of iterations per MCMC
chain</li>
<li>
<code>n.burnin</code> The number of iterations that are discarded to
ensure iterations are only saved once chains have converged</li>
<li>
<code>n.thin</code> The thinning rate which ensures that results are
only saved for 1 in every <code>n.thin</code> iterations per chain. This
can be increased to reduce autocorrelation in MCMC samples</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="model-selection">Model Selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h2>
<p>Detailed description of model selection based on statistical measures
such as Deviance Information Criterion (DIC) and residual deviance is
outside the scope of this vignette. However, the following approach for
model identification and selection is recommended in Pedder et al. <span class="citation">(2020)</span>, which also gives details on model fit
statistics used for comparison:</p>
<ol style="list-style-type: decimal">
<li>Identify candidate time-course functions based on observed data and
clinical/biological reasoning</li>
<li>Compare candidate time-course functions fitted with common relative
treatment effects on all time-course parameters</li>
<li>If no candidate time-course functions converge successfully,
absolute effects can be modeled on parameters for which convergence is
problematic</li>
<li>Compare selected common effects model to model(s) with random
effects on different time-course parameters</li>
<li>Compare model fitted with a univariate likelihood to one fitted with
a multivariate likelihood</li>
</ol>
<p>Finally the validity of the consistency assumption should be explored
in the selected final model (see <a href="#consistency-testing">Consistency Testing</a>).</p>
</div>
<div class="section level2">
<h2 id="mcmc-convergence">MCMC Convergence<a class="anchor" aria-label="anchor" href="#mcmc-convergence"></a>
</h2>
<p><code>MBNMAtime</code> runs Bayesian models in JAGS, which uses
Markov Chain Monte Carlo (MCMC) simulation <span class="citation">(JAGS
Computer Program 2017)</span>. However, the validity of results is
reliant on the MCMC chains having converged successfully on the
posterior densities of all parameters in the model. For highly
parameterised models run on relatively limited data, as is often the
case with MBNMA models, convergence can often be an challenge. Note that
convergence is <em>necessary</em> to be able to compare models and
evaluate model fit. However, successful convergence <em>does not</em>
imply good model fit.</p>
<p>A full explanation of how to facilitate and to check for convergence
is outside the scope of this vignette, but below are some simple steps
for checking convergence. None of these steps alone ensures convergence
has been successful, but interpretation of them jointly can provide
strong evidence of it.</p>
<ul>
<li>Rhat values close to 1 (&lt;1.1 is considered acceptable by some).
These are shown for monitored parameters in the summary statistics table
when an <code>"mbnma"</code> or <code>"nma"</code> object is
printed.</li>
<li>Trace plots that have a “fuzzy caterpillar” look that shows good
mixing of MCMC chains</li>
<li>Density plots that show a smooth posterior distribution that is
similar across all chains</li>
<li>Autocorrelation plots that show low autocorrelation between
neighbouring MCMC iterations (i.e. low correlation at higher lags)</li>
</ul>
<p>An HTML document with all the above convergence plots can easily be
generated for all parameters in the model simultaneously using
<code><a href="https://rdrr.io/pkg/mcmcplots/man/mcmcplot.html" class="external-link">mcmcplots::mcmcplot()</a></code>.</p>
<p>Two steps may improve convergence when using <code>MBNMAtime</code>.
One step is to run models for more iterations (this can be done using
the <code>n.iter</code> argument in <code><a href="../reference/mb.run.html">mb.run()</a></code>). It can take
time for MCMC chains to converge, particularly for non-linear models
with limited data. It is important to note that chains should only be
monitored <em>after</em> they have converged - increasing the number of
burn-in iterations ensures that this is the case (using the
<code>n.burnin</code> argument in <code><a href="../reference/mb.run.html">mb.run()</a></code>). Another method
to improve convergence is by providing more information to the model via
informative priors.</p>
<p>For a detailed review of MCMC convergence assessment see Sinharay
<span class="citation">(2003)</span>.</p>
</div>
<div class="section level2">
<h2 id="post-estimation">Post-Estimation<a class="anchor" aria-label="anchor" href="#post-estimation"></a>
</h2>
<div class="section level3">
<h3 id="deviance-plots">Deviance plots<a class="anchor" aria-label="anchor" href="#deviance-plots"></a>
</h3>
<p>To assess how well a model fits the data, it can be useful to look at
a plot of the contributions of each data point to the total deviance or
residual deviance. This can be done using <code><a href="../reference/devplot.html">devplot()</a></code>. As
individual deviance contributions are not automatically monitored in the
model, this might require the model to be run for additional
iterations.</p>
<p>Results can be plotted either as a scatter plot
(<code>plot.type="scatter"</code>) or a series of boxplots
(<code>plot.type="box"</code>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run a first-order fractional polynomial time-course MBNMA</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>, </span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tfpoly.html">tfpoly</a></span><span class="op">(</span>degree<span class="op">=</span><span class="fl">1</span>,</span>
<span>                          pool.1<span class="op">=</span><span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"random"</span>,</span>
<span>                          method.power1<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot a box-plot of deviance contributions (the default)</span></span>
<span><span class="fu"><a href="../reference/devplot.html">devplot</a></span><span class="op">(</span><span class="va">mbnma</span>, n.iter<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Change from version 0.2.2 onwards: corparam=FALSE as default</span></span>
<span><span class="co">#&gt; `dev` not monitored in mbnma$parameters.to.save.</span></span>
<span><span class="co">#&gt; additional iterations will be run in order to obtain results for `dev`</span></span></code></pre>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>From these plots we can see that whilst the model fit is typically
better at later time points, it fits very poorly at earlier time
points.</p>
<p>A function that appropriately captures the time-course shape should
show a reasonably flat shape of deviance contributions
(i.e. contributions should be similar across all time points).</p>
<p>If saved to an object, the output of <code><a href="../reference/devplot.html">devplot()</a></code> contains
the results for individual deviance contributions, and this can be used
to identify any extreme outliers.</p>
</div>
<div class="section level3">
<h3 id="fitted-values">Fitted values<a class="anchor" aria-label="anchor" href="#fitted-values"></a>
</h3>
<p>Another approach for assessing model fit can be to plot the fitted
values, using <code><a href="../reference/fitplot.html">fitplot()</a></code>. As with <code><a href="../reference/devplot.html">devplot()</a></code>,
this may require running additional model iterations to monitor
<code>theta</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot fitted and observed values with treatment labels</span></span>
<span><span class="fu"><a href="../reference/fitplot.html">fitplot</a></span><span class="op">(</span><span class="va">mbnma</span>, n.iter<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Fitted values are plotted as connecting lines and observed values in
the original dataset are plotted as points. These plots can be used to
identify if the model fits the data well for different treatments and at
different parts of the time-course.</p>
</div>
<div class="section level3">
<h3 id="forest-plots">Forest plots<a class="anchor" aria-label="anchor" href="#forest-plots"></a>
</h3>
<p>Forest plots can be easily generated from MBNMA models using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method on an <code>"mbnma"</code> object. By default
this will plot a separate panel for each time-course parameter in the
model. Forest plots can only be generated for parameters which vary by
treatment/class.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run a quadratic time-course MBNMA using the alogliptin dataset</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.alog</span>, </span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tpoly.html">tpoly</a></span><span class="op">(</span>degree<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          pool.1<span class="op">=</span><span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"random"</span>,</span>
<span>                          pool.2<span class="op">=</span><span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span></span>
<span>                          <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Change from version 0.2.2 onwards: corparam=FALSE as default</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mbnma</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="get-relative-calculating-differences-between-treatments-at-a-specified-time-point">
<code>get.relative()</code>: Calculating differences between
treatments at a specified time-point<a class="anchor" aria-label="anchor" href="#get-relative-calculating-differences-between-treatments-at-a-specified-time-point"></a>
</h3>
<p>Although <code><a href="../reference/mb.run.html">mb.run()</a></code> estimates the effects for different
treatments on different time-course parameters, these are not
necessarily easy to draw conclusions from, particularly for time-course
functions with less easily interpretable parameters.
<code><a href="../reference/get.relative.html">get.relative()</a></code> allows users to calculate mean differences
(or log-Ratio of Means if <code>mb.run(link="log")</code>) between
treatments at a specified time-point even if a subset, or even none of
the treatments have been investigated at that time-point in included
RCTs.</p>
<p>These results will then be reported on the scale on which the data
were modeled (i.e. depending on the link function specified in
<code><a href="../reference/mb.run.html">mb.run()</a></code>), rather than that of the specific time-course
parameters. Within the matrices of results, mean differences/relative
effects are shown as the row-defined treatment versus the column-defined
treatment.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.relative.html">get.relative</a></span><span class="op">(</span><span class="va">mbnma</span>, time<span class="op">=</span><span class="fl">20</span>,</span>
<span>                       treats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alog_100"</span>, <span class="st">"alog_50"</span>, <span class="st">"placebo"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">allres</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Treatment comparisons at time = 20</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt;      alog_100        0.9 (0.6, 1.2)   0.95 (-0.42, 2.3) </span></span>
<span><span class="co">#&gt; -0.9 (-1.2, -0.6)       alog_50       0.052 (-1.3, 1.4) </span></span>
<span><span class="co">#&gt; -0.95 (-2.3, 0.42) -0.052 (-1.4, 1.3)      placebo</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rank-ranking">
<code>rank()</code>: Ranking<a class="anchor" aria-label="anchor" href="#rank-ranking"></a>
</h3>
<p>Rankings can be calculated for different time-course parameters from
MBNMA models by using <code><a href="../reference/rank.html">rank()</a></code> on an <code>"mbnma"</code>
object. Any parameter monitored in an MBNMA model that varies by
treatment/class can be ranked. A vector of these is assigned to
<code>params</code>. <code>lower_better</code> indicates whether
negative scores should be ranked as “better” (<code>TRUE</code>) or
“worse” (<code>FALSE</code>)</p>
<p>In addition, it is possible to rank the Area Under the Curve (AUC)
for a particular treatment by adding <code>"auc"</code> to the vector of
<code>params</code> (included as the default). This will calculate the
area under the predicted response over time, and will therefore be a
function of all the time-course parameters in the model simultaneously.
However, it will be dependent on the range of times chosen to integrate
over (<code>int.range</code>), and a different choice of time-frame may
lead to different treatment rankings. <code>"auc"</code> can also not
currently be calculated from MBNMA models with more complex time-course
functions (piecewise, fractional polynomials), nor with MBNMA models
that use class effects.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify quantile for knot at 1 week</span></span>
<span><span class="va">timequant</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">network.pain</span><span class="op">$</span><span class="va">data.ab</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run a piecewise linear time-course MBNMA with a knot at 1 week</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"ls"</span>, knots <span class="op">=</span> <span class="va">timequant</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2 <span class="op">=</span> <span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Change from version 0.2.2 onwards: corparam=FALSE as default</span></span>
<span></span>
<span></span>
<span><span class="co"># Rank results based on AUC (calculated 0-10 weeks), more negative slopes considered to be "better"</span></span>
<span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rank.html">rank</a></span><span class="op">(</span><span class="va">mbnma</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auc"</span>, <span class="st">"d.2"</span><span class="op">)</span>, </span>
<span>                    int.range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>,  lower_better <span class="op">=</span> <span class="cn">TRUE</span>, n.iter<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Treatment rankings</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">d.2 ranking</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |  Mean| Median|  2.5%| 97.5%|</span></span>
<span><span class="co">#&gt; |:---------|-----:|------:|-----:|-----:|</span></span>
<span><span class="co">#&gt; |Pl_0      |  7.76|      8|  4.00|    12|</span></span>
<span><span class="co">#&gt; |Ce_100    | 16.53|     17|  7.00|    25|</span></span>
<span><span class="co">#&gt; |Ce_200    | 14.93|     15| 10.00|    20|</span></span>
<span><span class="co">#&gt; |Ce_400    | 17.30|     18|  8.00|    25|</span></span>
<span><span class="co">#&gt; |Du_90     | 14.43|      2|  1.00|    29|</span></span>
<span><span class="co">#&gt; |Et_10     | 23.49|     26|  4.00|    29|</span></span>
<span><span class="co">#&gt; |Et_30     | 13.81|     14|  6.00|    22|</span></span>
<span><span class="co">#&gt; |Et_5      |  4.94|      3|  1.00|    22|</span></span>
<span><span class="co">#&gt; |Et_60     | 23.49|     24| 14.00|    28|</span></span>
<span><span class="co">#&gt; |Et_90     | 20.28|     24|  3.00|    29|</span></span>
<span><span class="co">#&gt; |Lu_100    | 11.75|     11|  5.00|    19|</span></span>
<span><span class="co">#&gt; |Lu_200    | 13.06|     13|  7.00|    20|</span></span>
<span><span class="co">#&gt; |Lu_400    | 13.78|     14|  7.00|    21|</span></span>
<span><span class="co">#&gt; |Lu_NA     | 14.59|      2|  1.00|    29|</span></span>
<span><span class="co">#&gt; |Na_1000   | 20.33|     20| 15.00|    25|</span></span>
<span><span class="co">#&gt; |Na_1500   | 17.88|     18|  9.00|    25|</span></span>
<span><span class="co">#&gt; |Na_250    | 19.98|     23|  3.00|    29|</span></span>
<span><span class="co">#&gt; |Na_750    | 21.16|     22| 12.00|    27|</span></span>
<span><span class="co">#&gt; |Ox_44     |  8.29|      4|  1.00|    26|</span></span>
<span><span class="co">#&gt; |Ro_12     | 21.05|     24|  3.00|    29|</span></span>
<span><span class="co">#&gt; |Ro_125    | 13.90|     12|  1.00|    28|</span></span>
<span><span class="co">#&gt; |Ro_25     | 24.03|     25| 12.98|    29|</span></span>
<span><span class="co">#&gt; |Tr_100    |  5.47|      5|  2.00|    12|</span></span>
<span><span class="co">#&gt; |Tr_200    |  6.76|      6|  2.00|    14|</span></span>
<span><span class="co">#&gt; |Tr_300    |  9.17|      9|  4.00|    18|</span></span>
<span><span class="co">#&gt; |Tr_400    |  6.49|      6|  2.00|    16|</span></span>
<span><span class="co">#&gt; |Va_10     | 20.89|     22|  8.00|    28|</span></span>
<span><span class="co">#&gt; |Va_20     | 16.17|     17|  4.00|    26|</span></span>
<span><span class="co">#&gt; |Va_5      | 13.29|     13|  3.00|    25|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">auc ranking</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Treatment |  Mean| Median| 2.5%| 97.5%|</span></span>
<span><span class="co">#&gt; |:---------|-----:|------:|----:|-----:|</span></span>
<span><span class="co">#&gt; |Pl_0      | 26.16|     26|   24|    28|</span></span>
<span><span class="co">#&gt; |Ce_100    | 21.37|     22|   15|    25|</span></span>
<span><span class="co">#&gt; |Ce_200    | 13.87|     14|   10|    18|</span></span>
<span><span class="co">#&gt; |Ce_400    | 13.46|     13|    6|    21|</span></span>
<span><span class="co">#&gt; |Du_90     | 16.05|     21|    1|    29|</span></span>
<span><span class="co">#&gt; |Et_10     | 27.16|     28|   20|    29|</span></span>
<span><span class="co">#&gt; |Et_30     |  6.67|      6|    3|    12|</span></span>
<span><span class="co">#&gt; |Et_5      | 13.24|     12|    2|    27|</span></span>
<span><span class="co">#&gt; |Et_60     |  4.18|      4|    2|     8|</span></span>
<span><span class="co">#&gt; |Et_90     |  7.89|      5|    1|    26|</span></span>
<span><span class="co">#&gt; |Lu_100    | 13.56|     13|    9|    19|</span></span>
<span><span class="co">#&gt; |Lu_200    | 15.34|     16|   10|    20|</span></span>
<span><span class="co">#&gt; |Lu_400    |  9.59|      9|    5|    15|</span></span>
<span><span class="co">#&gt; |Lu_NA     | 13.62|      8|    1|    29|</span></span>
<span><span class="co">#&gt; |Na_1000   |  8.13|      8|    4|    13|</span></span>
<span><span class="co">#&gt; |Na_1500   |  9.22|      9|    4|    16|</span></span>
<span><span class="co">#&gt; |Na_250    | 27.61|     28|   22|    29|</span></span>
<span><span class="co">#&gt; |Na_750    | 19.13|     19|   11|    24|</span></span>
<span><span class="co">#&gt; |Ox_44     |  5.20|      4|    1|    19|</span></span>
<span><span class="co">#&gt; |Ro_12     | 20.89|     23|    4|    28|</span></span>
<span><span class="co">#&gt; |Ro_125    |  2.48|      2|    1|    14|</span></span>
<span><span class="co">#&gt; |Ro_25     | 16.70|     18|    5|    26|</span></span>
<span><span class="co">#&gt; |Tr_100    | 23.28|     24|   19|    26|</span></span>
<span><span class="co">#&gt; |Tr_200    | 22.30|     23|   18|    26|</span></span>
<span><span class="co">#&gt; |Tr_300    | 15.52|     16|    9|    22|</span></span>
<span><span class="co">#&gt; |Tr_400    | 11.37|     11|    5|    20|</span></span>
<span><span class="co">#&gt; |Va_10     | 21.22|     22|   13|    26|</span></span>
<span><span class="co">#&gt; |Va_20     | 13.51|     14|    5|    22|</span></span>
<span><span class="co">#&gt; |Va_5      | 16.29|     17|    6|    24|</span></span></code></pre></div>
<p>The output is an object of <code>class("mb.rank")</code>, containing
a list for each ranked parameter in <code>params</code>, which consists
of a summary table of rankings and raw information on treatment ranking
and probabilities. The summary median ranks with 95% credible intervals
can be simply displayed using <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>.</p>
<p>Histograms for ranking results can also be plotted using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method, which takes the raw MCMC ranking results
given in <code>rank.matrix</code> and plots the number of MCMC
iterations the parameter value for each treatment was ranked a
particular position.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ranking histograms for AUC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ranks</span>, params <span class="op">=</span> <span class="st">"auc"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<p>Cumulative rankograms indicating the probability of each treatment
being ranked 1st, 2nd, etc. for each ranked parameter can also be
plotted using <code><a href="../reference/cumrank.html">cumrank()</a></code>. These can be used to easily
compare how different treatments rank for each ranked parameter
simultaneously. By default, the Surface Under the Cumulative Ranking
curve (SUCRA) are also returned for each treatment and ranked parameter
<span class="citation">(Salanti, Ades, and Ioannidis 2011)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cumulative ranking for all ranked parameters</span></span>
<span><span class="fu"><a href="../reference/cumrank.html">cumrank</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 58 × 3</span></span></span>
<span><span class="co">#&gt;    treatment parameter sucra</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Pl_0      auc        3.34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Pl_0      d.2       21.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Ce_100    auc        8.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Ce_100    d.2       13.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Ce_200    auc       15.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Ce_200    d.2       14.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Ce_400    auc       16.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Ce_400    d.2       12.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Du_90     auc       13.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Du_90     d.2       14.9 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 48 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h3>
<p>After performing an MBNMA, responses can be predicted from the
parameter estimates using <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> on an
<code>"mbnma"</code> object. A number of important parameters need to be
identified to make robust predictions. However, default values can be
used that set values of zero for the reference treatment baseline and
time-course parameters which indicates that mean differences / relative
treatment effects should be estimated. For further information the help
file can be accessed using <code><a href="../reference/predict.mbnma.html">?predict.mbnma</a></code>.</p>
<p>One key parameter is <code>E0</code>, which defines what value(s) to
use for the predicted mean at time = 0. A single numeric value can be
given for <code>E0</code> to indicate a deterministic value, or a
function representing a random number generator (RNG) distribution in R
(stochastic) (e.g. <code>E0 = ~rnorm(n, 7, 0.2)</code>. These values can
be identified for the population of interest from external data
(e.g. observational/registry).</p>
<p>The more challenging parameter(s) to identify are those for the
network reference treatment time-course, supplied to
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> in the <code>ref.resp</code> argument. For
estimating mean differences / relative treatment effects over time this
does not need to be specified since typically in an MBNMA, relative
effects are estimated and the network reference effect is modeled as a
nuisance parameter. However, for predicting mean responses over time we
need to provide an input for the network reference treatment effect for
all time-course parameters modeled using <code>pool="rel"</code> so that
we can apply the relative effects estimated in our model to it. There
are two options for providing these values.</p>
<p>The first approach is to give values for each time-course parameter
modeled using relative effects to <code>ref.resp</code>. This is given
as a list, with a separate named element for each time-course parameter.
Each element can take either a single numeric value (deterministic), or
a function representing a random number generator distribution in R
(stochastic).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run an Emax time-course MBNMA using the osteoarthritis dataset</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/temax.html">temax</a></span><span class="op">(</span>pool.emax<span class="op">=</span><span class="st">"rel"</span>, method.emax<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                          pool.et50<span class="op">=</span><span class="st">"abs"</span>, method.et50<span class="op">=</span><span class="st">"common"</span><span class="op">)</span>,</span>
<span>                rho<span class="op">=</span><span class="st">"dunif(0,1)"</span>, covar<span class="op">=</span><span class="st">"varadj"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify placebo time-course parameters</span></span>
<span><span class="va">ref.params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>emax<span class="op">=</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict responses for a selection of treatments using a stochastic E0 and</span></span>
<span><span class="co"># placebo parameters defined in ref.params to estimate the network reference treatment effect</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mbnma</span>, treats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pl_0"</span>, <span class="st">"Ce_200"</span>, <span class="st">"Du_90"</span>, <span class="st">"Et_60"</span>, </span>
<span>                                        <span class="st">"Lu_400"</span>, <span class="st">"Na_1000"</span>, <span class="st">"Ox_44"</span>, <span class="st">"Ro_25"</span>,</span>
<span>                                        <span class="st">"Tr_300"</span>, <span class="st">"Va_20"</span><span class="op">)</span>,</span>
<span>                        E0<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">8</span>, <span class="fl">0.5</span><span class="op">)</span>, ref.resp<span class="op">=</span><span class="va">ref.params</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p>The second is to assign <code>ref.resp</code> a data frame composed
of single-arm studies of the network reference treatment. A separate
synthesis model for the reference treatment effect will then be run, and
the values from this used as the prediction reference treatment effect.
This dataset could be a series of observational studies measured at
multiple follow-up times that closely match the population of interest
for the prediction. Alternatively it could be a subset of data from the
original RCT dataset used for the MBNMA model (though this may be less
generalisable to the population of interest).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a dataset of network reference treatment responses over time</span></span>
<span><span class="va">placebo.df</span> <span class="op">&lt;-</span> <span class="va">network.pain</span><span class="op">$</span><span class="va">data.ab</span><span class="op">[</span><span class="va">network.pain</span><span class="op">$</span><span class="va">data.ab</span><span class="op">$</span><span class="va">treatment</span><span class="op">==</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Predict responses for a selection of treatments using a deterministic E0 and </span></span>
<span><span class="co">#placebo.df to model the network reference treatment effect</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mbnma</span>, treats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pl_0"</span>, <span class="st">"Ce_200"</span>, <span class="st">"Du_90"</span>, <span class="st">"Et_60"</span>, </span>
<span>                                        <span class="st">"Lu_400"</span>, <span class="st">"Na_1000"</span>, <span class="st">"Ox_44"</span>, <span class="st">"Ro_25"</span>,</span>
<span>                                        <span class="st">"Tr_300"</span>, <span class="st">"Va_20"</span><span class="op">)</span>,</span>
<span>                        E0<span class="op">=</span><span class="fl">10</span>, ref.resp<span class="op">=</span><span class="va">placebo.df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p>It is also possible specify the time points for which to make
predictions (<code>times</code>), given as a vector of positive numbers.
If left as the default then the maximum follow-up in the dataset will be
used as the upper limit for the range of predicted time-points.</p>
<p>An object of class <code>"mb.predict"</code> is returned, which is a
list of summary tables and MCMC prediction matrices for each treatment,
in addition to the original <code>mbnma</code> object. The
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method can be used to print mean posterior
predictions at each time point for each treatment.</p>
<p>Predicted values can also be plotted using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
method on an object of <code>class("mb.predict")</code>. Within the
default arguments, the median predicted network reference treatment
effect is overlaid on the predictions for each treatment. Setting
<code>overlay.ref = FALSE</code> prevents this and causes the network
reference treatment effect to be plotted as a separate panel. Shaded
counts of observations in the original dataset at each predicted time
point can be plotted over the 95% CrI for each treatment by setting
<code>disp.obs = TRUE</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, overlay.ref<span class="op">=</span><span class="cn">TRUE</span>, disp.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-36-1.png" width="672"></p>
<p>This can be used to identify any extrapolation/interpretation of the
time-course that might be occurring for a particular treatment, and
where predictions might therefore be problematic.</p>
<p>To illustrate a situation in which this could be very informative, we
can look at predictions for a quadratic time-course function fitted to
the Obesity dataset:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a quadratic time-course MBNMA to the Obesity dataset</span></span>
<span><span class="va">network.obese</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.network.html">mb.network</a></span><span class="op">(</span><span class="va">obesityBW_CFB</span>, reference <span class="op">=</span> <span class="st">"plac"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.obese</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tpoly.html">tpoly</a></span><span class="op">(</span>degree<span class="op">=</span><span class="fl">2</span>,</span>
<span>                          pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                          pool.2<span class="op">=</span><span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define stochastic values centred at zero for network reference treatment</span></span>
<span><span class="va">ref.params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta.1<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>, beta.2<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.0001</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict responses over the</span></span>
<span><span class="va">pred.obese</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mbnma</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, E0<span class="op">=</span><span class="fl">100</span>, treats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">15</span><span class="op">)</span>,</span>
<span>                        ref.resp<span class="op">=</span><span class="va">ref.params</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot predictions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred.obese</span>, disp.obs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-38-1.png" width="672"></p>
<p>As you can see, within the limits of the observed data the predicted
values appear reasonable. However, extrapolation beyond this for
<code>dexf_30MG</code> leads to some rather strange results, suggesting
an unrealistically huge increase in body weight after 50 weeks of
treatment. On the other hand, the predicted response at 50 weeks
follow-up in treatment 15 is within the limits of the observed data and
so are likely to be more justifiable.</p>
<div class="section level4">
<h4 id="plotting-lumped-nma-results">Plotting “lumped” NMA results<a class="anchor" aria-label="anchor" href="#plotting-lumped-nma-results"></a>
</h4>
<p>As a further addition to the plots of MBNMA predictions, it is
possible to add predicted results from an NMA model or multiple “lumped”
NMA models performed a different time “bins” (specified in
<code>overlay.nma</code>), time periods within which we are assuming
treatment effects are constant over time. This is similar to the output
generated by <code><a href="../reference/binplot.html">binplot()</a></code>. Either a <code>"random"</code> (the
default) or <code>"common"</code> effects NMA can be specified, and
model fit statistics are reported below the resulting plot.</p>
<p>This can be useful to assess if the MBNMA predictions are in
agreement with predictions from lumped NMA models over a specific set of
time-points, and can be a general indicator of the fit of the
time-course model. However, it is important to note that the NMA model
is not necessarily the more robust model, since it ignores potential
differences in treatment effects that may arise from lumping time-points
together. The wider the range specified in <code>overlay.nma</code>, the
greater the effect of lumping and the stronger the assumption of
similarity between studies.</p>
<p>The NMA predictions are plotted over the range specified in
<code>overlay.nma</code> as a horizontal line representing the posterior
median, with the 95%CrI shown by a shaded rectangle. The NMA predictions
in theory represent those for <em>any time-points within this range</em>
since they lump together data at all these time-points, though the width
(x-axis) of the shaded rectangle represents the range of time-points for
studies included in each time bin. Predictions for treatments that are
disconnected from the network reference treatment at data points
specified within <code>overlay.nma</code> cannot be estimated so are not
included.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overlay predictions from lumped NMAs between 5-8 and between 8-15 weeks follow-up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, overlay.nma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">15</span><span class="op">)</span>, n.iter<span class="op">=</span><span class="fl">20000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reference treatment in plots is Pl_0</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=5 and time=8</span></span>
<span><span class="co">#&gt; Running overlay.nma for time=8 and time=15</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-39-1.png" width="672"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="consistency-testing">Consistency Testing<a class="anchor" aria-label="anchor" href="#consistency-testing"></a>
</h2>
<p>When performing an MBNMA by pooling relative treatment effects
(<code>pool="rel"</code>), the modelling approach assumes consistency
between direct and indirect evidence within a network. This is an
incredibly useful assumption as it allows us to improve precision on
existing direct estimates, or to estimate relative effects between
treatments that have not been compared in head-to-head trials, by making
use of indirect evidence.</p>
<p>However, if this assumption does not hold it is extremely problematic
for inference, so it is important to be able to test it. A number of
different approaches exist to allow for this in standard Network
Meta-Analysis <span class="citation">(Dias et al. 2013)</span>. Two of
these have been implemented within <code>MBNMAtime</code>. It is
important to note that in some model specifications there is likely to
be sharing of model parameters (e.g. heterogeneity parameters,
correlation coefficients) across networks which will lead to more
conservative tests for consistency, and may lead to an inflated type II
error.</p>
<p>Consistency is also likely to differ depending on the model used.
Failing to appropriately model the time-course function may in fact
induce inconsistency in the data. “Lumping” together different time
points from studies in standard NMA is known to be a potential cause of
inconsistency, which is one of the reasons why accounting for
time-course using MBNMA is important <span class="citation">(Pedder et
al. 2019)</span>. When performing MBNMA, this is why it is important to
first try to identify the best model possible in terms of time-course
and common/random effects, and then to test for consistency within that
model, rather than testing for consistency in models that are known not
be be a good fit to the data.</p>
<p>Consistency testing can only be performed in networks in which closed
loops of treatment comparisons exist that are drawn from independent
sources of evidence. In networks which do not have any such loops of
evidence, consistency cannot be formally tested (though it may still be
present). The <code><a href="../reference/mb.nodesplit.comparisons.html">mb.nodesplit.comparisons()</a></code> function
identifies loops of evidence that conform to this property, and
identifies a treatment comparison within that loop for which direct and
indirect evidence can be compared using node-splitting (see below).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loops of evidence within the alogliptin dataset</span></span>
<span><span class="va">splits.alog</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.nodesplit.comparisons.html">mb.nodesplit.comparisons</a></span><span class="op">(</span><span class="va">network.alog</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">splits.alog</span><span class="op">)</span></span>
<span><span class="co">#&gt;   t1 t2    path</span></span>
<span><span class="co">#&gt; 8  3  4 3-&gt;1-&gt;4</span></span>
<span><span class="co">#&gt; 7  2  5 2-&gt;1-&gt;5</span></span>
<span><span class="co">#&gt; 6  2  4 2-&gt;1-&gt;4</span></span>
<span><span class="co">#&gt; 5  2  3 2-&gt;1-&gt;3</span></span></code></pre></div>
<div class="section level3">
<h3 id="unrelated-mean-effects-ume-models">Unrelated Mean Effects (UME) models<a class="anchor" aria-label="anchor" href="#unrelated-mean-effects-ume-models"></a>
</h3>
<p>To check for consistency using UME we fit a model that does not
assume consistency relationships, and that only models the direct
relative effects between each arm in a study and the study reference
treatment. If the consistency assumption holds true then the results
from the UME model and the MBNMA will be very similar. However, if there
is a discrepancy between direct and indirect evidence in the network,
then the consistency assumption may not be valid, and the UME results
are likely differ in several ways:</p>
<ul>
<li>The UME model may provide a better fit to the data, as measured by
deviance or residual deviance</li>
<li>The between-study SD for different parameters may be lower in the
UME model</li>
<li>Individual relative effects may differ in magnitude or (more
severely) in direction for different treatment comparisons between UME
and MBNMA models</li>
</ul>
<p>UME can be fitted to any time-course parameter which has been
modelled using relative effects (<code>pool="rel"</code>). UME can be
specified for each time-course parameter in separate analyses, or can be
modelled all at once in a single analysis.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify quantile for knot at 0.5 weeks</span></span>
<span><span class="va">timequant</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">network.pain</span><span class="op">$</span><span class="va">data.ab</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a B-spline MBNMA with common relative effects on slope.1 and slope.2</span></span>
<span><span class="va">mbnma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"bs"</span>, knots<span class="op">=</span><span class="va">timequant</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2 <span class="op">=</span> <span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span></span>
<span>                            <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a UME model on both spline coefficients simultaneously</span></span>
<span><span class="va">ume</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"bs"</span>, knots<span class="op">=</span><span class="va">timequant</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2 <span class="op">=</span> <span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span></span>
<span>                            <span class="op">)</span>,</span>
<span>              UME<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a UME model on the 1nd coefficient only</span></span>
<span><span class="va">ume.slope.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"bs"</span>, knots<span class="op">=</span><span class="va">timequant</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2 <span class="op">=</span> <span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span></span>
<span>                            <span class="op">)</span>,</span>
<span>              UME<span class="op">=</span><span class="st">"beta.1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a UME model on the 2nd coefficient only</span></span>
<span><span class="va">ume.slope.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.run.html">mb.run</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                fun<span class="op">=</span><span class="fu"><a href="../reference/tspline.html">tspline</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"bs"</span>, knots<span class="op">=</span><span class="va">timequant</span>,</span>
<span>                            pool.1 <span class="op">=</span> <span class="st">"rel"</span>, method.1<span class="op">=</span><span class="st">"common"</span>,</span>
<span>                            pool.2 <span class="op">=</span> <span class="st">"rel"</span>, method.2<span class="op">=</span><span class="st">"common"</span></span>
<span>                            <span class="op">)</span>,</span>
<span>              UME<span class="op">=</span><span class="st">"beta.2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "Deviance for mbnma: -104.54"</span></span>
<span><span class="co">#&gt; [1] "Deviance for ume on beta.1 and beta.2: -115.5"</span></span>
<span><span class="co">#&gt; [1] "Deviance for ume on beta.1: -117.0"</span></span>
<span><span class="co">#&gt; [1] "Deviance for ume on beta.2: -115.2"</span></span></code></pre>
<p>By comparing the deviance (or residual deviance) of models with UME
fitted on different time-course parameters and the MBNMA model, we can
see that there is some reduction in deviance in the different UME
models. Given that deviance is lowest when UME is modelled only on
<code>beta.1</code> this is suggestive of inconsistency between direct
and indirect evidence on <code>beta.1</code>, but perhaps also on
<code>beta.2</code> given that modelling UME on this also leads to a
reduction in deviance.</p>
<p>Direct estimates from UME and MBNMA models can also be compared to
examine in greater detail how inconsistency may be affecting results.
However, it is important to note that whilst a discrepancy between UME
and MBNMA results may be seen for a particular relative effect, the
inconsistency is not exclusively applicable to that particular treatment
comparison and may originate from other comparisons in the network. This
is why consistency checking is so important, as a violation of the
consistency assumption raises concerns about estimates for all
treatments within the network.</p>
</div>
<div class="section level3">
<h3 id="node-splitting">Node-splitting<a class="anchor" aria-label="anchor" href="#node-splitting"></a>
</h3>
<p>Another approach for consistency checking is node-splitting. This
splits contributions for a particular treatment comparison into direct
and indirect evidence, and the two can then be compared to test their
similarity. <code><a href="../reference/mb.nodesplit.html">mb.nodesplit()</a></code> takes similar arguments to
<code><a href="../reference/mb.run.html">mb.run()</a></code> that define the underlying MBNMA model in which to
test for consistency, and returns an object of
<code>class("mb.nodesplit")</code>. There are two additional arguments
required:</p>
<p><code>comparisons</code> indicates on which treatment comparisons to
perform a node-split. The default value for this is to automatically
identify all comparisons for which both direct and indirect evidence
contributions are available using
<code><a href="../reference/mb.nodesplit.comparisons.html">mb.nodesplit.comparisons()</a></code>.</p>
<p><code>nodesplit.parameters</code> indicates on which time-course
parameters to perform a node-split. This can only take time-course
parameters that have been assigned relative effects in the model
(<code>pool="rel"</code>). Alternatively the default <code>"all"</code>
can be used to split on all available time-course parameters in the
model that have been pooled using relative effects.</p>
<p>As up to two models will need to be run for each treatment comparison
to split, this function can take some time to run.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nodesplit using an Emax MBNMA</span></span>
<span><span class="va">nodesplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.nodesplit.html">mb.nodesplit</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                          fun<span class="op">=</span><span class="fu"><a href="../reference/temax.html">temax</a></span><span class="op">(</span>pool.emax<span class="op">=</span><span class="st">"rel"</span>, method.emax <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                                    pool.et50<span class="op">=</span><span class="st">"abs"</span>, method.et50 <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span>,</span>
<span>                          nodesplit.parameters<span class="op">=</span><span class="st">"all"</span></span>
<span>                          <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nodesplit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Node-splitting analysis of inconsistency</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">emax</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Comparison        | p-value| Median|   2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------|-------:|------:|------:|------:|</span></span>
<span><span class="co">#&gt; |Ro_25 vs Ce_200   |   0.028|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        |  0.384| -0.460|  1.205|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        | -0.541| -1.020| -0.064|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span>
<span><span class="co">#&gt; |Na_1000 vs Ce_200 |   0.007|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        |  0.228| -0.213|  0.684|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        | -0.515| -0.891| -0.137|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span></code></pre></div>
<p>Performing the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method on an object of
<code>class("mb.nodesplit")</code> prints a summary of the node-split
results to the console, whilst the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method will
return a data frame of posterior summaries for direct and indirect
estimates for each split treatment comparison and each time-course
parameter.</p>
<p>It is possible to generate different plots of each node-split
comparison using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot forest plots of direct and indirect results for each node-split comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nodesplit</span>, plot.type<span class="op">=</span><span class="st">"forest"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot posterior densities of direct and indirect results for each node-split comparisons</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nodesplit</span>, plot.type<span class="op">=</span><span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-47-1.png" width="672"><img src="MBNMAtime_files/figure-html/unnamed-chunk-47-2.png" width="672"></p>
<p>As a further example, if we use a different time-course function
(1-parameter ITP) that is a less good fit for the data, and perform a
node-split on the <code>rate</code> time-course parameter, we find that
there seems to be a strong discrepancy between direct and indirect
estimates. This is strong evidence to reject the consistency assumption,
and to either (as in this case) try to identify a better fitting model,
or to re-examine the dataset to try to explain whether differences in
studies making different comparisons may be causing this.</p>
<p>This highlights the importance of testing for consistency
<em>after</em> identifying an appropriate time-course and common/random
treatment effects model.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nodesplit on emax of 1-parameter ITP MBNMA</span></span>
<span><span class="va">ns.itp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mb.nodesplit.html">mb.nodesplit</a></span><span class="op">(</span><span class="va">network.pain</span>,</span>
<span>                       fun<span class="op">=</span><span class="fu"><a href="../reference/titp.html">titp</a></span><span class="op">(</span>pool.emax <span class="op">=</span> <span class="st">"rel"</span>, method.emax<span class="op">=</span><span class="st">"common"</span><span class="op">)</span>,</span>
<span>                       nodesplit.parameters<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ns.itp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; Node-splitting analysis of inconsistency</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; ========================================</span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">emax</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Comparison        | p-value| Median|   2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------|-------:|------:|------:|------:|</span></span>
<span><span class="co">#&gt; |Ro_25 vs Ce_200   |    0.09|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        |  0.163| -0.200|  0.542|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        | -0.136| -0.440|  0.126|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span>
<span><span class="co">#&gt; |Na_1000 vs Ce_200 |    0.00|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        |  0.002| -0.129|  0.137|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        | -0.378| -0.513| -0.249|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold; text-decoration: underline;">rate</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |Comparison        | p-value| Median|   2.5%|  97.5%|</span></span>
<span><span class="co">#&gt; |:-----------------|-------:|------:|------:|------:|</span></span>
<span><span class="co">#&gt; |Ro_25 vs Ce_200   |   0.396|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        | 21.295|  0.869| 68.722|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        | 14.079|  0.261| 67.282|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span>
<span><span class="co">#&gt; |Na_1000 vs Ce_200 |   0.082|       |       |       |</span></span>
<span><span class="co">#&gt; |-&gt; direct         |        | 21.176|  1.085| 69.708|</span></span>
<span><span class="co">#&gt; |-&gt; indirect       |        |  0.320| -0.088| 38.232|</span></span>
<span><span class="co">#&gt; |                  |        |       |       |       |</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ns.itp</span>, plot.type<span class="op">=</span><span class="st">"forest"</span><span class="op">)</span></span></code></pre></div>
<p><img src="MBNMAtime_files/figure-html/unnamed-chunk-50-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p><code>MBNMAtime</code> provides a complete set of functions that
allow for meta-analysis of longitudinal time-course data and plotting of
a number of informative graphics. Functions are provided for ranking,
prediction, and for assessing consistency when modelling using relative
effects. By accounting for time-course in meta-analysis this can help to
explain heterogeneity/inconsistency that may arise when lumping together
different time-points using conventional NMA.</p>
<p>The package allows for flexible modelling of either relative or
absolute effects interchangeably on different time-course parameters
within the same analysis, whilst providing a straightforward syntax with
which to define these models.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-GMD2" class="csl-entry">
Daly, C., N. J. Welton, S. Dias, S. Anwer, and A. E. Ades. 2021.
<span>“NICE Guideline Methodology Document 2: Meta-Analysis of
Continuous Outcomes.”</span> Population Health Sciences, University of
Bristol; Centre for Reviews; Dissemination; Centre for Health Economics,
University of York. <a href="https://www.bristol.ac.uk/media-library/sites/social-community-medicine/documents/mpes/gmd-2-continuous-jan2021.pdf" class="external-link">https://www.bristol.ac.uk/media-library/sites/social-community-medicine/documents/mpes/gmd-2-continuous-jan2021.pdf</a>.
</div>
<div id="ref-dias2016" class="csl-entry">
Dias, S., and A. E. Ades. 2016. <span>“Absolute or Relative Effects?
Arm-Based Synthesis of Trial Data.”</span> Journal Article. <em>Res
Synth Methods</em> 7 (1): 23–28. <a href="https://doi.org/10.1002/jrsm.1184" class="external-link">https://doi.org/10.1002/jrsm.1184</a>.
</div>
<div id="ref-dias2013" class="csl-entry">
Dias, S., N. J. Welton, A. J. Sutton, D. M. Caldwell, G. Lu, and A. E.
Ades. 2013. <span>“Evidence Synthesis for Decision Making 4:
Inconsistency in Networks of Evidence Based on Randomized Controlled
Trials.”</span> Journal Article. <em>Med Decis Making</em> 33 (5):
641–56. <a href="https://doi.org/10.1177/0272989X12455847" class="external-link">https://doi.org/10.1177/0272989X12455847</a>.
</div>
<div id="ref-friedrich2011" class="csl-entry">
Friedrich, J. O., N. K. J. Adhikari, and J. Beyene. 2011. <span>“Ratio
of Means for Analyzing Continuous Outcomes in Meta-Analysis Performed as
Well as Mean Difference Methods.”</span> Journal Article. <em>Journal of
Clinical Epidemiology</em> 64 (5): 556–64. <a href="https://doi.org/10.1016/j.jclinepi.2010.09.016" class="external-link">https://doi.org/10.1016/j.jclinepi.2010.09.016</a>.
</div>
<div id="ref-gelman2003" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, and D. B. Rubin. 2003.
<em>Bayesian Data Analysis</em>. Book. 2nd ed. CRC Press.
</div>
<div id="ref-hong2016" class="csl-entry">
Hong, H., H. Chu, J. Zhang, and B. P. Carlin. 2016. <span>“A Bayesian
Missing Data Framework for Generalized Multiple Outcome Mixed Treatment
Comparisons.”</span> Journal Article. <em>Res Synth Methods</em> 7 (1):
6–22. <a href="https://doi.org/10.1002/jrsm.1153" class="external-link">https://doi.org/10.1002/jrsm.1153</a>.
</div>
<div id="ref-jags" class="csl-entry">
JAGS Computer Program. 2017. <a href="https://mcmc-jags.sourceforge.io/" class="external-link">https://mcmc-jags.sourceforge.io/</a>.
</div>
<div id="ref-jansen2015" class="csl-entry">
Jansen, J. P., M. C. Vieira, and S. Cope. 2015. <span>“Network
Meta-Analysis of Longitudinal Data Using Fractional Polynomials.”</span>
Journal Article. <em>Stat Med</em> 34 (15): 2294–2311. <a href="https://doi.org/10.1002/sim.6492" class="external-link">https://doi.org/10.1002/sim.6492</a>.
</div>
<div id="ref-karabis2013" class="csl-entry">
Karabis, A., L. Lindner, M. Mocarski, E. Huisman, and A. Greening. 2013.
<span>“Comparative Efficacy of Aclidinium Versus Glycopyrronium and
Tiotropium, as Maintenance Treatment of Moderate to Severe COPD
Patients: A Systematic Review and Network Meta-Analysis.”</span> Journal
Article. <em>Int J Chron Obstruct Pulmon Dis</em> 8: 405–23. <a href="https://doi.org/10.2147/COPD.S48967" class="external-link">https://doi.org/10.2147/COPD.S48967</a>.
</div>
<div id="ref-karahalios2017" class="csl-entry">
Karahalios, A. E., G. Salanti, S. L. Turner, G. P. Herbison, I. R.
White, A. A. Veroniki, A. Nikolakopoulou, and J. E. McKenzie. 2017.
<span>“An Investigation of the Impact of Using Different Methods for
Network Meta-Analysis: A Protocol for an Empirical Evaluation.”</span>
Journal Article. <em>Syst Rev</em> 6 (1): 119. <a href="https://doi.org/10.1186/s13643-017-0511-x" class="external-link">https://doi.org/10.1186/s13643-017-0511-x</a>.
</div>
<div id="ref-covstruct" class="csl-entry">
Kincaid, Chuck. 2005. <span>“Guidelines for Selecting the Covariance
Structure in Mixed Model Analysis.”</span> Paper 198-30. COMSYS
Information Technology Services. <a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf" class="external-link">https://support.sas.com/resources/papers/proceedings/proceedings/sugi30/198-30.pdf</a>.
</div>
<div id="ref-langford2016" class="csl-entry">
Langford, O., J. K. Aronson, G. van Valkenhoef, and R. J. Stevens. 2016.
<span>“Methods for Meta-Analysis of Pharmacodynamic Dose-Response Data
with Application to Multi-Arm Studies of Alogliptin.”</span> Journal
Article. <em>Stat Methods Med Res</em>. <a href="https://doi.org/10.1177/0962280216637093" class="external-link">https://doi.org/10.1177/0962280216637093</a>.
</div>
<div id="ref-lu2004" class="csl-entry">
Lu, G., and A. E. Ades. 2004. <span>“Combination of Direct and Indirect
Evidence in Mixed Treatment Comparisons.”</span> Journal Article.
<em>Stat Med</em> 23 (20): 3105–24. <a href="https://doi.org/10.1002/sim.1875" class="external-link">https://doi.org/10.1002/sim.1875</a>.
</div>
<div id="ref-pedder2020" class="csl-entry">
Pedder, H., M. Boucher, S. Dias, M. Bennetts, and N. J. Welton. 2020.
<span>“Performance of Model-Based Network Meta-Analysis (MBNMA) of
Time-Course Relationships: A Simulation Study.”</span> Journal Article.
<em>Research Synthesis Methods</em> 11 (5): 678–97. <a href="https://doi.org/10.1002/jrsm.1432" class="external-link">https://doi.org/10.1002/jrsm.1432</a>.
</div>
<div id="ref-pedder2019" class="csl-entry">
Pedder, H., S. Dias, M. Bennetts, M. Boucher, and N. J. Welton. 2019.
<span>“Modelling Time-Course Relationships with Multiple Treatments:
Model-Based Network Meta-Analysis for Continuous Summary
Outcomes.”</span> Journal Article. <em>Res Synth Methods</em> 10 (2):
267–86.
</div>
<div id="ref-plummer2008" class="csl-entry">
Plummer, M. 2008. <span>“Penalized Loss Functions for Bayesian Model
Comparison.”</span> Journal Article. <em>Biostatistics</em> 9 (3):
523–39. <a href="https://pubmed.ncbi.nlm.nih.gov/18209015/" class="external-link">https://pubmed.ncbi.nlm.nih.gov/18209015/</a>.
</div>
<div id="ref-jagsmanual" class="csl-entry">
———. 2017. <em>JAGS User Manual</em>. Version 4.3.0. <a href="https://people.stat.sc.edu/hansont/stat740/jags_user_manual.pdf" class="external-link">https://people.stat.sc.edu/hansont/stat740/jags_user_manual.pdf</a>.
</div>
<div id="ref-salanti2011" class="csl-entry">
Salanti, G., A. E. Ades, and J. P. Ioannidis. 2011. <span>“Graphical
Methods and Numerical Summaries for Presenting Results from
Multiple-Treatment Meta-Analysis: An Overview and Tutorial.”</span>
Journal Article. <em>J Clin Epidemiol</em> 64 (2): 163–71. <a href="https://doi.org/10.1016/j.jclinepi.2010.03.016" class="external-link">https://doi.org/10.1016/j.jclinepi.2010.03.016</a>.
</div>
<div id="ref-sinharay" class="csl-entry">
Sinharay, S. 2003. <span>“Assessing Convergence of the Markov Chain
Monte Carlo Algorithms: A Review.”</span> RR-03-07. ETS Research Report
Series. <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/j.2333-8504.2003.tb01899.x" class="external-link">https://onlinelibrary.wiley.com/doi/pdf/10.1002/j.2333-8504.2003.tb01899.x</a>.
</div>
<div id="ref-spiegelhalter2002" class="csl-entry">
Spiegelhalter, D. J., N. G. Best, B. P. Carlin, and A. van der Linde.
2002. <span>“Bayesian Measures of Model Complexity and Fit.”</span>
Journal Article. <em>J R Statistic Soc B</em> 64 (4): 583–639.
</div>
<div id="ref-tallarita2019" class="csl-entry">
Tallarita, M., M. De lorio, and G. Baio. 2019. <span>“A Comparative
Review of Network Meta-Analysis Models in Longitudinal Randomized
Controlled Trial.”</span> Journal Article. <em>Statistics in
Medicine</em> 38 (16): 3053–72. <a href="https://doi.org/10.1002/sim.8169" class="external-link">https://doi.org/10.1002/sim.8169</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Hugo Pedder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
